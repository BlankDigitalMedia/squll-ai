(function(){"use strict";var Ni=document.createElement("style");Ni.textContent=`.panel.svelte-1ou1zgf{position:relative;width:100%;height:100%;background:#ffffff40;backdrop-filter:blur(24px) saturate(180%);-webkit-backdrop-filter:blur(24px) saturate(180%);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 32px #00000014,inset 0 1px #ffffff4d;display:flex;flex-direction:column;min-width:300px;min-height:200px;overflow:hidden;color:#000}.notes-tab-container .panel{border-radius:0;border:none;min-width:0;min-height:0}.panel.dragging.svelte-1ou1zgf{cursor:move}.panel.resizing.svelte-1ou1zgf{cursor:nwse-resize}.header.svelte-1ou1zgf{background:#ffffff26;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);padding:12px 16px;border-bottom:1px solid rgba(255,255,255,.1);cursor:move;-webkit-user-select:none;user-select:none;flex-shrink:0;display:flex;align-items:center;justify-content:space-between;gap:12px}.header.tab-mode.svelte-1ou1zgf{cursor:default}.header-title.svelte-1ou1zgf{font-size:14px;font-weight:500;color:#000000d9;text-shadow:0 1px 2px rgba(255,255,255,.5);flex:1}.minimize-button.svelte-1ou1zgf{background:transparent;border:none;color:#000000b3;font-size:18px;font-weight:600;line-height:1;cursor:pointer;padding:4px 8px;border-radius:4px;transition:background-color .15s ease,color .15s ease;flex-shrink:0;outline:none}.minimize-button.svelte-1ou1zgf:hover{background:#0000001a;color:#000000e6}.minimize-button.svelte-1ou1zgf:active{background:#00000026}.editor-container.svelte-1ou1zgf{flex:1;overflow:auto;padding:24px;background:#ffffff0d;color:#000}.editor.svelte-1ou1zgf{width:100%;min-height:100%;outline:none;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;font-size:16px;line-height:1.6;color:#000!important;white-space:pre-wrap;word-wrap:break-word}.editor.svelte-1ou1zgf:focus{outline:none}.editor.svelte-1ou1zgf:empty:before{content:"Start typing...";color:#00000080!important}.resize-handle.svelte-1ou1zgf{position:absolute;bottom:0;right:0;width:20px;height:20px;cursor:nwse-resize;background:linear-gradient(-45deg,transparent 40%,rgba(0,0,0,.3) 40%,rgba(0,0,0,.3) 50%,transparent 50%)}.resize-handle.svelte-1ou1zgf:hover{background:linear-gradient(-45deg,transparent 40%,rgba(0,0,0,.5) 40%,rgba(0,0,0,.5) 50%,transparent 50%)}.floating-button.svelte-1q8htkr{position:absolute;width:56px;height:56px;border-radius:50%;background:#2d2d2df2;border:1px solid rgba(255,255,255,.1);color:#fff;font-size:24px;font-weight:600;cursor:move;display:flex;align-items:center;justify-content:center;-webkit-user-select:none;user-select:none;box-shadow:0 4px 12px #0000004d;transition:transform .1s ease,box-shadow .1s ease;padding:0;margin:0;outline:none}.floating-button.svelte-1q8htkr:hover{transform:scale(1.05);box-shadow:0 6px 16px #0006}.floating-button.svelte-1q8htkr:active{transform:scale(.98)}.floating-button.dragging.svelte-1q8htkr{cursor:grabbing;transform:scale(1.05)}
/*$vite$:1*/`,document.head.appendChild(Ni);const Mi=!1;var Sa=Array.isArray,Oa=Array.prototype.indexOf,Ta=Array.from,Ca=Object.defineProperty,sn=Object.getOwnPropertyDescriptor,Aa=Object.getOwnPropertyDescriptors,Da=Object.prototype,Ra=Array.prototype,Bi=Object.getPrototypeOf,qi=Object.isExtensible;function Ka(i){for(var a=0;a<i.length;a++)i[a]()}function Fi(){var i,a,s=new Promise((c,g)=>{i=c,a=g});return{promise:s,resolve:i,reject:a}}const ye=2,Rn=4,Sr=8,Qe=16,Je=32,gt=64,Kn=128,ze=512,me=1024,Oe=2048,Ze=4096,Ue=8192,bt=16384,Or=32768,qt=65536,Li=1<<17,zi=1<<18,Ft=1<<19,Ia=1<<20,ln=32768,Tr=1<<21,Cr=1<<22,ut=1<<23,In=Symbol("$state"),ja=Symbol(""),Lt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Na(i){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ma(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ba(i){throw new Error("https://svelte.dev/e/effect_in_teardown")}function qa(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Fa(i){throw new Error("https://svelte.dev/e/effect_orphan")}function La(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function za(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ua(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ya(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ha(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Va=2,ge=Symbol(),Wa="http://www.w3.org/1999/xhtml";function $a(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Ui(i){return i===this.v}let Xa=!1,Re=null;function zt(i){Re=i}function Ar(i,a=!1,s){Re={p:Re,i:!1,c:null,e:null,s:i,x:null,l:null}}function Dr(i){var a=Re,s=a.e;if(s!==null){a.e=null;for(var c of s)oo(c)}return a.i=!0,Re=a.p,{}}function Yi(){return!0}let Ut=[];function Ga(){var i=Ut;Ut=[],Ka(i)}function jn(i){if(Ut.length===0){var a=Ut;queueMicrotask(()=>{a===Ut&&Ga()})}Ut.push(i)}function Hi(i){var a=ne;if(a===null)return J.f|=ut,i;if((a.f&Or)===0){if((a.f&Kn)===0)throw i;a.b.error(i)}else Yt(i,a)}function Yt(i,a){for(;a!==null;){if((a.f&Kn)!==0)try{a.b.error(i);return}catch(s){i=s}a=a.parent}throw i}const Nn=new Set;let he=null,Ke=null,st=[],Rr=null,Kr=!1;class Ye{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#s=null;#a=[];#u=[];skipped_effects=new Set;is_fork=!1;process(a){st=[],this.apply();var s={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const c of a)this.#i(c,s);this.is_fork||this.#l(),this.#r>0||this.is_fork?(this.#o(s.effects),this.#o(s.render_effects),this.#o(s.block_effects)):(he=null,Vi(s.render_effects),Vi(s.effects),this.#s?.resolve()),Ke=null}#i(a,s){a.f^=me;for(var c=a.first;c!==null;){var g=c.f,w=(g&(Je|gt))!==0,P=w&&(g&me)!==0,S=P||(g&Ue)!==0||this.skipped_effects.has(c);if((c.f&Kn)!==0&&c.b?.is_pending()&&(s={parent:s,effect:c,effects:[],render_effects:[],block_effects:[]}),!S&&c.fn!==null){w?c.f^=me:(g&Rn)!==0?s.effects.push(c):dn(c)&&((c.f&Qe)!==0&&s.block_effects.push(c),pn(c));var O=c.first;if(O!==null){c=O;continue}}var C=c.parent;for(c=c.next;c===null&&C!==null;)C===s.effect&&(this.#o(s.effects),this.#o(s.render_effects),this.#o(s.block_effects),s=s.parent),c=C.next,C=C.parent}}#o(a){for(const s of a)((s.f&Oe)!==0?this.#a:this.#u).push(s),be(s,me)}capture(a,s){this.previous.has(a)||this.previous.set(a,s),(a.f&ut)===0&&(this.current.set(a,a.v),Ke?.set(a,a.v))}activate(){he=this,this.apply()}deactivate(){he=null,Ke=null}flush(){if(this.activate(),st.length>0){if(Qa(),he!==null&&he!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const a of this.#t)a(this);this.#t.clear()}#l(){if(this.#r===0){for(const a of this.#e)a();this.#e.clear()}this.#n===0&&this.#c()}#c(){if(Nn.size>1){this.previous.clear();var a=Ke,s=!0,c={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const g of Nn){if(g===this){s=!1;continue}const w=[];for(const[S,O]of this.current){if(g.current.has(S))if(s&&O!==g.current.get(S))g.current.set(S,O);else continue;w.push(S)}if(w.length===0)continue;const P=[...g.current.keys()].filter(S=>!this.current.has(S));if(P.length>0){const S=new Set,O=new Map;for(const C of w)Wi(C,P,S,O);if(st.length>0){he=g,g.apply();for(const C of st)g.#i(C,c);st=[],g.deactivate()}}}he=null,Ke=a}this.committed=!0,Nn.delete(this)}increment(a){this.#n+=1,a&&(this.#r+=1)}decrement(a){this.#n-=1,a&&(this.#r-=1),this.revive()}revive(){for(const a of this.#a)be(a,Oe),_t(a);for(const a of this.#u)be(a,Ze),_t(a);this.#a=[],this.#u=[],this.flush()}oncommit(a){this.#e.add(a)}ondiscard(a){this.#t.add(a)}settled(){return(this.#s??=Fi()).promise}static ensure(){if(he===null){const a=he=new Ye;Nn.add(he),Ye.enqueue(()=>{he===a&&a.flush()})}return he}static enqueue(a){jn(a)}apply(){}}function Qa(){var i=wt;Kr=!0;try{var a=0;for(yo(!0);st.length>0;){var s=Ye.ensure();if(a++>1e3){var c,g;Ja()}s.process(st),lt.clear()}}finally{Kr=!1,yo(i),Rr=null}}function Ja(){try{La()}catch(i){Yt(i,Rr)}}let et=null;function Vi(i){var a=i.length;if(a!==0){for(var s=0;s<a;){var c=i[s++];if((c.f&(bt|Ue))===0&&dn(c)&&(et=new Set,pn(c),c.deps===null&&c.first===null&&c.nodes_start===null&&(c.teardown===null&&c.ac===null?fo(c):c.fn=null),et?.size>0)){lt.clear();for(const g of et){if((g.f&(bt|Ue))!==0)continue;const w=[g];let P=g.parent;for(;P!==null;)et.has(P)&&(et.delete(P),w.push(P)),P=P.parent;for(let S=w.length-1;S>=0;S--){const O=w[S];(O.f&(bt|Ue))===0&&pn(O)}}et.clear()}}et=null}}function Wi(i,a,s,c){if(!s.has(i)&&(s.add(i),i.reactions!==null))for(const g of i.reactions){const w=g.f;(w&ye)!==0?Wi(g,a,s,c):(w&(Cr|Qe))!==0&&(w&Oe)===0&&$i(g,a,c)&&(be(g,Oe),_t(g))}}function $i(i,a,s){const c=s.get(i);if(c!==void 0)return c;if(i.deps!==null)for(const g of i.deps){if(a.includes(g))return!0;if((g.f&ye)!==0&&$i(g,a,s))return s.set(g,!0),!0}return s.set(i,!1),!1}function _t(i){for(var a=Rr=i;a.parent!==null;){a=a.parent;var s=a.f;if(Kr&&a===ne&&(s&Qe)!==0&&(s&zi)===0)return;if((s&(gt|Je))!==0){if((s&me)===0)return;a.f^=me}}st.push(a)}function Za(i){let a=0,s=Bn(0),c;return()=>{Ln()&&(U(s),ao(()=>(a===0&&(c=qr(()=>i(()=>cn(s)))),a+=1,()=>{jn(()=>{a-=1,a===0&&(c?.(),c=void 0,cn(s))})})))}}var eu=qt|Ft|Kn;function tu(i,a,s){new nu(i,a,s)}class nu{parent;#e=!1;#t;#n=null;#r;#s;#a;#u=null;#i=null;#o=null;#l=null;#c=null;#d=0;#f=0;#p=!1;#h=null;#b=Za(()=>(this.#h=Bn(this.#d),()=>{this.#h=null}));constructor(a,s,c){this.#t=a,this.#r=s,this.#s=c,this.parent=ne.b,this.#e=!!this.#r.pending,this.#a=so(()=>{ne.b=this;{var g=this.#m();try{this.#u=nt(()=>c(g))}catch(w){this.error(w)}this.#f>0?this.#y():this.#e=!1}return()=>{this.#c?.remove()}},eu)}#_(){try{this.#u=nt(()=>this.#s(this.#t))}catch(a){this.error(a)}this.#e=!1}#w(){const a=this.#r.pending;a&&(this.#i=nt(()=>a(this.#t)),Ye.enqueue(()=>{var s=this.#m();this.#u=this.#v(()=>(Ye.ensure(),nt(()=>this.#s(s)))),this.#f>0?this.#y():(fn(this.#i,()=>{this.#i=null}),this.#e=!1)}))}#m(){var a=this.#t;return this.#e&&(this.#c=Fn(),this.#t.before(this.#c),a=this.#c),a}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#v(a){var s=ne,c=J,g=Re;We(this.#a),Te(this.#a),zt(this.#a.ctx);try{return a()}catch(w){return Hi(w),null}finally{We(s),Te(c),zt(g)}}#y(){const a=this.#r.pending;this.#u!==null&&(this.#l=document.createDocumentFragment(),this.#l.append(this.#c),vo(this.#u,this.#l)),this.#i===null&&(this.#i=nt(()=>a(this.#t)))}#g(a){if(!this.has_pending_snippet()){this.parent&&this.parent.#g(a);return}this.#f+=a,this.#f===0&&(this.#e=!1,this.#i&&fn(this.#i,()=>{this.#i=null}),this.#l&&(this.#t.before(this.#l),this.#l=null))}update_pending_count(a){this.#g(a),this.#d+=a,this.#h&&qn(this.#h,this.#d)}get_effect_pending(){return this.#b(),U(this.#h)}error(a){var s=this.#r.onerror;let c=this.#r.failed;if(this.#p||!s&&!c)throw a;this.#u&&(Ie(this.#u),this.#u=null),this.#i&&(Ie(this.#i),this.#i=null),this.#o&&(Ie(this.#o),this.#o=null);var g=!1,w=!1;const P=()=>{if(g){$a();return}g=!0,w&&Ha(),Ye.ensure(),this.#d=0,this.#o!==null&&fn(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#u=this.#v(()=>(this.#p=!1,nt(()=>this.#s(this.#t)))),this.#f>0?this.#y():this.#e=!1};var S=J;try{Te(null),w=!0,s?.(a,P),w=!1}catch(O){Yt(O,this.#a&&this.#a.parent)}finally{Te(S)}c&&jn(()=>{this.#o=this.#v(()=>{Ye.ensure(),this.#p=!0;try{return nt(()=>{c(this.#t,()=>a,()=>P)})}catch(O){return Yt(O,this.#a.parent),null}finally{this.#p=!1}})})}}function ru(i,a,s,c){const g=ou;if(s.length===0&&i.length===0){c(a.map(g));return}var w=he,P=ne,S=iu();function O(){Promise.all(s.map(C=>au(C))).then(C=>{S();try{c([...a.map(g),...C])}catch(L){(P.f&bt)===0&&Yt(L,P)}w?.deactivate(),Mn()}).catch(C=>{Yt(C,P)})}i.length>0?Promise.all(i).then(()=>{S();try{return O()}finally{w?.deactivate(),Mn()}}):O()}function iu(){var i=ne,a=J,s=Re,c=he;return function(w=!0){We(i),Te(a),zt(s),w&&c?.activate()}}function Mn(){We(null),Te(null),zt(null)}function ou(i){var a=ye|Oe,s=J!==null&&(J.f&ye)!==0?J:null;return ne!==null&&(ne.f|=Ft),{ctx:Re,deps:null,effects:null,equals:Ui,f:a,fn:i,reactions:null,rv:0,v:ge,wv:0,parent:s??ne,ac:null}}function au(i,a){let s=ne;s===null&&Ma();var c=s.b,g=void 0,w=Bn(ge),P=!J,S=new Map;return mu(()=>{var O=Fi();g=O.promise;try{Promise.resolve(i()).then(O.resolve,O.reject).then(()=>{C===he&&C.committed&&C.deactivate(),Mn()})}catch(q){O.reject(q),Mn()}var C=he;if(P){var L=!c.is_pending();c.update_pending_count(1),C.increment(L),S.get(C)?.reject(Lt),S.delete(C),S.set(C,O)}const B=(q,H=void 0)=>{if(C.activate(),H)H!==Lt&&(w.f|=ut,qn(w,H));else{(w.f&ut)!==0&&(w.f^=ut),qn(w,q);for(const[Z,ue]of S){if(S.delete(Z),Z===C)break;ue.reject(Lt)}}P&&(c.update_pending_count(-1),C.decrement(L))};O.promise.then(B,q=>B(null,q||"unknown"))}),du(()=>{for(const O of S.values())O.reject(Lt)}),new Promise(O=>{function C(L){function B(){L===g?O(w):C(g)}L.then(B,B)}C(g)})}function Xi(i){var a=i.effects;if(a!==null){i.effects=null;for(var s=0;s<a.length;s+=1)Ie(a[s])}}function uu(i){for(var a=i.parent;a!==null;){if((a.f&ye)===0)return a;a=a.parent}return null}function Ir(i){var a,s=ne;We(uu(i));try{i.f&=~ln,Xi(i),a=xo(i)}finally{We(s)}return a}function Gi(i){var a=Ir(i);if(i.equals(a)||(i.v=a,i.wv=_o()),!Ht)if(Ke!==null)Ln()&&Ke.set(i,i.v);else{var s=(i.f&ze)===0?Ze:me;be(i,s)}}let jr=new Set;const lt=new Map;let Qi=!1;function Bn(i,a){var s={f:0,v:i,reactions:null,equals:Ui,rv:0,wv:0};return s}function ae(i,a){const s=Bn(i);return xu(s),s}function te(i,a,s=!1){J!==null&&(!Ve||(J.f&Li)!==0)&&Yi()&&(J.f&(ye|Qe|Cr|Li))!==0&&!rt?.includes(i)&&Ya();let c=s?He(a):a;return qn(i,c)}function qn(i,a){if(!i.equals(a)){var s=i.v;Ht?lt.set(i,a):lt.set(i,s),i.v=a;var c=Ye.ensure();c.capture(i,s),(i.f&ye)!==0&&((i.f&Oe)!==0&&Ir(i),be(i,(i.f&ze)!==0?me:Ze)),i.wv=_o(),Ji(i,Oe),ne!==null&&(ne.f&me)!==0&&(ne.f&(Je|gt))===0&&(Fe===null?Eu([i]):Fe.push(i)),!c.is_fork&&jr.size>0&&!Qi&&su()}return a}function su(){Qi=!1;const i=Array.from(jr);for(const a of i)(a.f&me)!==0&&be(a,Ze),dn(a)&&pn(a);jr.clear()}function cn(i){te(i,i.v+1)}function Ji(i,a){var s=i.reactions;if(s!==null)for(var c=s.length,g=0;g<c;g++){var w=s[g],P=w.f,S=(P&Oe)===0;if(S&&be(w,a),(P&ye)!==0){var O=w;Ke?.delete(O),(P&ln)===0&&(P&ze&&(w.f|=ln),Ji(O,Ze))}else S&&((P&Qe)!==0&&et!==null&&et.add(w),_t(w))}}function He(i){if(typeof i!="object"||i===null||In in i)return i;const a=Bi(i);if(a!==Da&&a!==Ra)return i;var s=new Map,c=Sa(i),g=ae(0),w=xt,P=S=>{if(xt===w)return S();var O=J,C=xt;Te(null),bo(w);var L=S();return Te(O),bo(C),L};return c&&s.set("length",ae(i.length)),new Proxy(i,{defineProperty(S,O,C){(!("value"in C)||C.configurable===!1||C.enumerable===!1||C.writable===!1)&&za();var L=s.get(O);return L===void 0?L=P(()=>{var B=ae(C.value);return s.set(O,B),B}):te(L,C.value,!0),!0},deleteProperty(S,O){var C=s.get(O);if(C===void 0){if(O in S){const L=P(()=>ae(ge));s.set(O,L),cn(g)}}else te(C,ge),cn(g);return!0},get(S,O,C){if(O===In)return i;var L=s.get(O),B=O in S;if(L===void 0&&(!B||sn(S,O)?.writable)&&(L=P(()=>{var H=He(B?S[O]:ge),Z=ae(H);return Z}),s.set(O,L)),L!==void 0){var q=U(L);return q===ge?void 0:q}return Reflect.get(S,O,C)},getOwnPropertyDescriptor(S,O){var C=Reflect.getOwnPropertyDescriptor(S,O);if(C&&"value"in C){var L=s.get(O);L&&(C.value=U(L))}else if(C===void 0){var B=s.get(O),q=B?.v;if(B!==void 0&&q!==ge)return{enumerable:!0,configurable:!0,value:q,writable:!0}}return C},has(S,O){if(O===In)return!0;var C=s.get(O),L=C!==void 0&&C.v!==ge||Reflect.has(S,O);if(C!==void 0||ne!==null&&(!L||sn(S,O)?.writable)){C===void 0&&(C=P(()=>{var q=L?He(S[O]):ge,H=ae(q);return H}),s.set(O,C));var B=U(C);if(B===ge)return!1}return L},set(S,O,C,L){var B=s.get(O),q=O in S;if(c&&O==="length")for(var H=C;H<B.v;H+=1){var Z=s.get(H+"");Z!==void 0?te(Z,ge):H in S&&(Z=P(()=>ae(ge)),s.set(H+"",Z))}if(B===void 0)(!q||sn(S,O)?.writable)&&(B=P(()=>ae(void 0)),te(B,He(C)),s.set(O,B));else{q=B.v!==ge;var ue=P(()=>He(C));te(B,ue)}var Ne=Reflect.getOwnPropertyDescriptor(S,O);if(Ne?.set&&Ne.set.call(L,C),!q){if(c&&typeof O=="string"){var Me=s.get("length"),Ae=Number(O);Number.isInteger(Ae)&&Ae>=Me.v&&te(Me,Ae+1)}cn(g)}return!0},ownKeys(S){U(g);var O=Reflect.ownKeys(S).filter(B=>{var q=s.get(B);return q===void 0||q.v!==ge});for(var[C,L]of s)L.v!==ge&&!(C in S)&&O.push(C);return O},setPrototypeOf(){Ua()}})}var Zi,eo,to,no;function lu(){if(Zi===void 0){Zi=window,eo=/Firefox/.test(navigator.userAgent);var i=Element.prototype,a=Node.prototype,s=Text.prototype;to=sn(a,"firstChild").get,no=sn(a,"nextSibling").get,qi(i)&&(i.__click=void 0,i.__className=void 0,i.__attributes=null,i.__style=void 0,i.__e=void 0),qi(s)&&(s.__t=void 0)}}function Fn(i=""){return document.createTextNode(i)}function ro(i){return to.call(i)}function Nr(i){return no.call(i)}function Mr(i,a){return ro(i)}function Br(i,a=1,s=!1){let c=i;for(;a--;)c=Nr(c);return c}function cu(){return!1}function io(i){var a=J,s=ne;Te(null),We(null);try{return i()}finally{Te(a),We(s)}}function fu(i){ne===null&&(J===null&&Fa(),qa()),Ht&&Ba()}function hu(i,a){var s=a.last;s===null?a.last=a.first=i:(s.next=i,i.prev=s,a.last=i)}function tt(i,a,s,c=!0){var g=ne;g!==null&&(g.f&Ue)!==0&&(i|=Ue);var w={ctx:Re,deps:null,nodes_start:null,nodes_end:null,f:i|Oe|ze,first:null,fn:a,last:null,next:null,parent:g,b:g&&g.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(s)try{pn(w),w.f|=Or}catch(O){throw Ie(w),O}else a!==null&&_t(w);if(c){var P=w;if(s&&P.deps===null&&P.teardown===null&&P.nodes_start===null&&P.first===P.last&&(P.f&Ft)===0&&(P=P.first,(i&Qe)!==0&&(i&qt)!==0&&P!==null&&(P.f|=qt)),P!==null&&(P.parent=g,g!==null&&hu(P,g),J!==null&&(J.f&ye)!==0&&(i&gt)===0)){var S=J;(S.effects??=[]).push(P)}}return w}function Ln(){return J!==null&&!Ve}function du(i){const a=tt(Sr,null,!1);return be(a,me),a.teardown=i,a}function pu(i){fu();var a=ne.f,s=!J&&(a&Je)!==0&&(a&Or)===0;if(s){var c=Re;(c.e??=[]).push(i)}else return oo(i)}function oo(i){return tt(Rn|Ia,i,!1)}function vu(i){Ye.ensure();const a=tt(gt|Ft,i,!0);return(s={})=>new Promise(c=>{s.outro?fn(a,()=>{Ie(a),c(void 0)}):(Ie(a),c(void 0))})}function yu(i){return tt(Rn,i,!1)}function mu(i){return tt(Cr|Ft,i,!0)}function ao(i,a=0){return tt(Sr|a,i,!0)}function uo(i,a=[],s=[],c=[],g=!1){ru(c,a,s,w=>{tt(g?Rn:Sr,()=>i(...w.map(U)),!0)})}function so(i,a=0){var s=tt(Qe|a,i,!0);return s}function nt(i,a=!0){return tt(Je|Ft,i,!0,a)}function lo(i){var a=i.teardown;if(a!==null){const s=Ht,c=J;mo(!0),Te(null);try{a.call(null)}finally{mo(s),Te(c)}}}function co(i,a=!1){var s=i.first;for(i.first=i.last=null;s!==null;){const g=s.ac;g!==null&&io(()=>{g.abort(Lt)});var c=s.next;(s.f&gt)!==0?s.parent=null:Ie(s,a),s=c}}function gu(i){for(var a=i.first;a!==null;){var s=a.next;(a.f&Je)===0&&Ie(a),a=s}}function Ie(i,a=!0){var s=!1;(a||(i.f&zi)!==0)&&i.nodes_start!==null&&i.nodes_end!==null&&(bu(i.nodes_start,i.nodes_end),s=!0),co(i,a&&!s),zn(i,0),be(i,bt);var c=i.transitions;if(c!==null)for(const w of c)w.stop();lo(i);var g=i.parent;g!==null&&g.first!==null&&fo(i),i.next=i.prev=i.teardown=i.ctx=i.deps=i.fn=i.nodes_start=i.nodes_end=i.ac=null}function bu(i,a){for(;i!==null;){var s=i===a?null:Nr(i);i.remove(),i=s}}function fo(i){var a=i.parent,s=i.prev,c=i.next;s!==null&&(s.next=c),c!==null&&(c.prev=s),a!==null&&(a.first===i&&(a.first=c),a.last===i&&(a.last=s))}function fn(i,a,s=!0){var c=[];ho(i,c,!0),_u(c,()=>{s&&Ie(i),a&&a()})}function _u(i,a){var s=i.length;if(s>0){var c=()=>--s||a();for(var g of i)g.out(c)}else a()}function ho(i,a,s){if((i.f&Ue)===0){if(i.f^=Ue,i.transitions!==null)for(const P of i.transitions)(P.is_global||s)&&a.push(P);for(var c=i.first;c!==null;){var g=c.next,w=(c.f&qt)!==0||(c.f&Je)!==0&&(i.f&Qe)!==0;ho(c,a,w?s:!1),c=g}}}function wu(i){po(i,!0)}function po(i,a){if((i.f&Ue)!==0){i.f^=Ue,(i.f&me)===0&&(be(i,Oe),_t(i));for(var s=i.first;s!==null;){var c=s.next,g=(s.f&qt)!==0||(s.f&Je)!==0;po(s,g?a:!1),s=c}if(i.transitions!==null)for(const w of i.transitions)(w.is_global||a)&&w.in()}}function vo(i,a){for(var s=i.nodes_start,c=i.nodes_end;s!==null;){var g=s===c?null:Nr(s);a.append(s),s=g}}let wt=!1;function yo(i){wt=i}let Ht=!1;function mo(i){Ht=i}let J=null,Ve=!1;function Te(i){J=i}let ne=null;function We(i){ne=i}let rt=null;function xu(i){J!==null&&(rt===null?rt=[i]:rt.push(i))}let Pe=null,je=0,Fe=null;function Eu(i){Fe=i}let go=1,hn=0,xt=hn;function bo(i){xt=i}function _o(){return++go}function dn(i){var a=i.f;if((a&Oe)!==0)return!0;if(a&ye&&(i.f&=~ln),(a&Ze)!==0){var s=i.deps;if(s!==null)for(var c=s.length,g=0;g<c;g++){var w=s[g];if(dn(w)&&Gi(w),w.wv>i.wv)return!0}(a&ze)!==0&&Ke===null&&be(i,me)}return!1}function wo(i,a,s=!0){var c=i.reactions;if(c!==null&&!rt?.includes(i))for(var g=0;g<c.length;g++){var w=c[g];(w.f&ye)!==0?wo(w,a,!1):a===w&&(s?be(w,Oe):(w.f&me)!==0&&be(w,Ze),_t(w))}}function xo(i){var a=Pe,s=je,c=Fe,g=J,w=rt,P=Re,S=Ve,O=xt,C=i.f;Pe=null,je=0,Fe=null,J=(C&(Je|gt))===0?i:null,rt=null,zt(i.ctx),Ve=!1,xt=++hn,i.ac!==null&&(io(()=>{i.ac.abort(Lt)}),i.ac=null);try{i.f|=Tr;var L=i.fn,B=L(),q=i.deps;if(Pe!==null){var H;if(zn(i,je),q!==null&&je>0)for(q.length=je+Pe.length,H=0;H<Pe.length;H++)q[je+H]=Pe[H];else i.deps=q=Pe;if(wt&&Ln()&&(i.f&ze)!==0)for(H=je;H<q.length;H++)(q[H].reactions??=[]).push(i)}else q!==null&&je<q.length&&(zn(i,je),q.length=je);if(Yi()&&Fe!==null&&!Ve&&q!==null&&(i.f&(ye|Ze|Oe))===0)for(H=0;H<Fe.length;H++)wo(Fe[H],i);return g!==null&&g!==i&&(hn++,Fe!==null&&(c===null?c=Fe:c.push(...Fe))),(i.f&ut)!==0&&(i.f^=ut),B}catch(Z){return Hi(Z)}finally{i.f^=Tr,Pe=a,je=s,Fe=c,J=g,rt=w,zt(P),Ve=S,xt=O}}function ku(i,a){let s=a.reactions;if(s!==null){var c=Oa.call(s,i);if(c!==-1){var g=s.length-1;g===0?s=a.reactions=null:(s[c]=s[g],s.pop())}}s===null&&(a.f&ye)!==0&&(Pe===null||!Pe.includes(a))&&(be(a,Ze),(a.f&ze)!==0&&(a.f^=ze,a.f&=~ln),Xi(a),zn(a,0))}function zn(i,a){var s=i.deps;if(s!==null)for(var c=a;c<s.length;c++)ku(i,s[c])}function pn(i){var a=i.f;if((a&bt)===0){be(i,me);var s=ne,c=wt;ne=i,wt=!0;try{(a&Qe)!==0?gu(i):co(i),lo(i);var g=xo(i);i.teardown=typeof g=="function"?g:null,i.wv=go;var w;Mi&&Xa&&(i.f&Oe)!==0&&i.deps}finally{wt=c,ne=s}}}function U(i){var a=i.f,s=(a&ye)!==0;if(J!==null&&!Ve){var c=ne!==null&&(ne.f&bt)!==0;if(!c&&!rt?.includes(i)){var g=J.deps;if((J.f&Tr)!==0)i.rv<hn&&(i.rv=hn,Pe===null&&g!==null&&g[je]===i?je++:Pe===null?Pe=[i]:Pe.includes(i)||Pe.push(i));else{(J.deps??=[]).push(i);var w=i.reactions;w===null?i.reactions=[J]:w.includes(J)||w.push(J)}}}if(Ht){if(lt.has(i))return lt.get(i);if(s){var P=i,S=P.v;return((P.f&me)===0&&P.reactions!==null||ko(P))&&(S=Ir(P)),lt.set(P,S),S}}else if(s){if(P=i,Ke?.has(P))return Ke.get(P);dn(P)&&Gi(P),wt&&Ln()&&(P.f&ze)===0&&Eo(P)}else if(Ke?.has(i))return Ke.get(i);if((i.f&ut)!==0)throw i.v;return i.v}function Eo(i){if(i.deps!==null){i.f^=ze;for(const a of i.deps)(a.reactions??=[]).push(i),(a.f&ye)!==0&&(a.f&ze)===0&&Eo(a)}}function ko(i){if(i.v===ge)return!0;if(i.deps===null)return!1;for(const a of i.deps)if(lt.has(a)||(a.f&ye)!==0&&ko(a))return!0;return!1}function qr(i){var a=Ve;try{return Ve=!0,i()}finally{Ve=a}}const Pu=-7169;function be(i,a){i.f=i.f&Pu|a}const Su=["touchstart","touchmove"];function Ou(i){return Su.includes(i)}const Po=new Set,Fr=new Set;function So(i){for(var a=0;a<i.length;a++)Po.add(i[a]);for(var s of Fr)s(i)}let Oo=null;function Un(i){var a=this,s=a.ownerDocument,c=i.type,g=i.composedPath?.()||[],w=g[0]||i.target;Oo=i;var P=0,S=Oo===i&&i.__root;if(S){var O=g.indexOf(S);if(O!==-1&&(a===document||a===window)){i.__root=a;return}var C=g.indexOf(a);if(C===-1)return;O<=C&&(P=O)}if(w=g[P]||i.target,w!==a){Ca(i,"currentTarget",{configurable:!0,get(){return w||s}});var L=J,B=ne;Te(null),We(null);try{for(var q,H=[];w!==null;){var Z=w.assignedSlot||w.parentNode||w.host||null;try{var ue=w["__"+c];ue!=null&&(!w.disabled||i.target===w)&&ue.call(w,i)}catch(Ne){q?H.push(Ne):q=Ne}if(i.cancelBubble||Z===a||Z===null)break;w=Z}if(q){for(let Ne of H)queueMicrotask(()=>{throw Ne});throw q}}finally{i.__root=a,delete i.currentTarget,Te(L),We(B)}}}function Tu(i){var a=document.createElement("template");return a.innerHTML=i.replaceAll("<!>","<!---->"),a.content}function Cu(i,a){var s=ne;s.nodes_start===null&&(s.nodes_start=i,s.nodes_end=a)}function Lr(i,a){var s=(a&Va)!==0,c,g=!i.startsWith("<!>");return()=>{c===void 0&&(c=Tu(g?i:"<!>"+i),c=ro(c));var w=s||eo?document.importNode(c,!0):c.cloneNode(!0);return Cu(w,w),w}}function zr(i,a){i!==null&&i.before(a)}function Ur(i,a){return Au(i,a)}const Vt=new Map;function Au(i,{target:a,anchor:s,props:c={},events:g,context:w,intro:P=!0}){lu();var S=new Set,O=B=>{for(var q=0;q<B.length;q++){var H=B[q];if(!S.has(H)){S.add(H);var Z=Ou(H);a.addEventListener(H,Un,{passive:Z});var ue=Vt.get(H);ue===void 0?(document.addEventListener(H,Un,{passive:Z}),Vt.set(H,1)):Vt.set(H,ue+1)}}};O(Ta(Po)),Fr.add(O);var C=void 0,L=vu(()=>{var B=s??a.appendChild(Fn());return tu(B,{pending:()=>{}},q=>{if(w){Ar({});var H=Re;H.c=w}g&&(c.$$events=g),C=i(q,c)||{},w&&Dr()}),()=>{for(var q of S){a.removeEventListener(q,Un);var H=Vt.get(q);--H===0?(document.removeEventListener(q,Un),Vt.delete(q)):Vt.set(q,H)}Fr.delete(O),B!==s&&B.parentNode?.removeChild(B)}});return Du.set(C,L),C}let Du=new WeakMap;class Ru{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(a,s=!0){this.anchor=a,this.#r=s}#s=()=>{var a=he;if(this.#e.has(a)){var s=this.#e.get(a),c=this.#t.get(s);if(c)wu(c);else{var g=this.#n.get(s);g&&(this.#t.set(s,g.effect),this.#n.delete(s),g.fragment.lastChild.remove(),this.anchor.before(g.fragment),c=g.effect)}for(const[w,P]of this.#e){if(this.#e.delete(w),w===a)break;const S=this.#n.get(P);S&&(Ie(S.effect),this.#n.delete(P))}for(const[w,P]of this.#t){if(w===s)continue;const S=()=>{if(Array.from(this.#e.values()).includes(w)){var C=document.createDocumentFragment();vo(P,C),C.append(Fn()),this.#n.set(w,{effect:P,fragment:C})}else Ie(P);this.#t.delete(w)};this.#r||!c?fn(P,S,!1):S()}}};#a=a=>{this.#e.delete(a);const s=Array.from(this.#e.values());for(const[c,g]of this.#n)s.includes(c)||(Ie(g.effect),this.#n.delete(c))};ensure(a,s){var c=he,g=cu();if(s&&!this.#t.has(a)&&!this.#n.has(a))if(g){var w=document.createDocumentFragment(),P=Fn();w.append(P),this.#n.set(a,{effect:nt(()=>s(P)),fragment:w})}else this.#t.set(a,nt(()=>s(this.anchor)));if(this.#e.set(c,a),g){for(const[S,O]of this.#t)S===a?c.skipped_effects.delete(O):c.skipped_effects.add(O);for(const[S,O]of this.#n)S===a?c.skipped_effects.delete(O.effect):c.skipped_effects.add(O.effect);c.oncommit(this.#s),c.ondiscard(this.#a)}else this.#s()}}function Ku(i,a,s=!1){var c=new Ru(i),g=s?qt:0;function w(P,S){c.ensure(P,S)}so(()=>{var P=!1;a((S,O=!0)=>{P=!0,w(O,S)}),P||w(!1,null)},g)}const To=[...` 	
\r\f\xA0\v\uFEFF`];function Iu(i,a,s){var c=i==null?"":""+i;if(s){for(var g in s)if(s[g])c=c?c+" "+g:g;else if(c.length)for(var w=g.length,P=0;(P=c.indexOf(g,P))>=0;){var S=P+w;(P===0||To.includes(c[P-1]))&&(S===c.length||To.includes(c[S]))?c=(P===0?"":c.substring(0,P))+c.substring(S+1):P=S}}return c===""?null:c}function Yr(i,a,s,c,g,w){var P=i.__className;if(P!==s||P===void 0){var S=Iu(s,c,w);S==null?i.removeAttribute("class"):i.className=S,i.__className=s}else if(w&&g!==w)for(var O in w){var C=!!w[O];(g==null||C!==!!g[O])&&i.classList.toggle(O,C)}return w}const ju=Symbol("is custom element"),Nu=Symbol("is html");function Hr(i,a,s,c){var g=Mu(i);g[a]!==(g[a]=s)&&(a==="loading"&&(i[ja]=s),s==null?i.removeAttribute(a):typeof s!="string"&&Bu(i).includes(a)?i[a]=s:i.setAttribute(a,s))}function Mu(i){return i.__attributes??={[ju]:i.nodeName.includes("-"),[Nu]:i.namespaceURI===Wa}}var Co=new Map;function Bu(i){var a=i.getAttribute("is")||i.nodeName,s=Co.get(a);if(s)return s;Co.set(a,s=[]);for(var c,g=i,w=Element.prototype;w!==g;){c=Aa(g);for(var P in c)c[P].set&&s.push(P);g=Bi(g)}return s}function Ao(i,a){return i===a||i?.[In]===a}function Vr(i={},a,s,c){return yu(()=>{var g,w;return ao(()=>{g=w,w=[],qr(()=>{i!==s(...w)&&(a(i,...w),g&&Ao(s(...g),i)&&a(null,...g))})}),()=>{jn(()=>{w&&Ao(s(...w),i)&&a(null,...w)})}}),i}function qu(i,a,s,c){var g=c,w=!0,P=()=>(w&&(w=!1,g=c),g),S;S=i[a],S===void 0&&c!==void 0&&(S=P());var O;return O=()=>{var C=i[a];return C===void 0?P():(w=!0,C)},O}function Do(i){Re===null&&Na(),pu(()=>{const a=qr(i);if(typeof a=="function")return a})}const Fu="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Fu);var Lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zu(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Yn={exports:{}},Uu=Yn.exports,Ro;function Yu(){return Ro||(Ro=1,(function(i,a){(function(s,c){i.exports=c()})(Uu,function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])})(e,t)},c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function g(e,t,n){for(var r,o=0,u=t.length;o<u;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var w=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Lu,P=Object.keys,S=Array.isArray;function O(e,t){return typeof t!="object"||P(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||w.Promise||(w.Promise=Promise);var C=Object.getPrototypeOf,L={}.hasOwnProperty;function B(e,t){return L.call(e,t)}function q(e,t){typeof t=="function"&&(t=t(C(e))),(typeof Reflect>"u"?P:Reflect.ownKeys)(t).forEach(function(n){Z(e,n,t[n])})}var H=Object.defineProperty;function Z(e,t,n,r){H(e,t,O(n&&B(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function ue(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Z(e.prototype,"constructor",e),{extend:q.bind(null,e.prototype)}}}}var Ne=Object.getOwnPropertyDescriptor,Me=[].slice;function Ae(e,t,n){return Me.call(e,t,n)}function se(e,t){return t(e)}function _e(e){if(!e)throw new Error("Assertion Failed")}function De(e){w.setImmediate?setImmediate(e):setTimeout(e,0)}function de(e,t){if(typeof t=="string"&&B(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,o=t.length;r<o;++r){var u=de(e,t[r]);n.push(u)}return n}var l=t.indexOf(".");if(l!==-1){var f=e[t.substr(0,l)];return f==null?void 0:de(f,t.substr(l+1))}}function fe(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){_e(typeof n!="string"&&"length"in n);for(var r=0,o=t.length;r<o;++r)fe(e,t[r],n[r])}else{var u,l,f=t.indexOf(".");f!==-1?(u=t.substr(0,f),(l=t.substr(f+1))===""?n===void 0?S(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n:fe(f=!(f=e[u])||!B(e,u)?e[u]={}:f,l,n)):n===void 0?S(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Xt(e){var t,n={};for(t in e)B(e,t)&&(n[t]=e[t]);return n}var Gn=[].concat;function yn(e){return Gn.apply([],e)}var Ct="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(yn([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return w[e]}),Qn=new Set(Ct.map(function(e){return w[e]})),Pt=null;function V(e){return Pt=new WeakMap,e=(function t(n){if(!n||typeof n!="object")return n;var r=Pt.get(n);if(r)return r;if(S(n)){r=[],Pt.set(n,r);for(var o=0,u=n.length;o<u;++o)r.push(t(n[o]))}else if(Qn.has(n.constructor))r=n;else{var l,f=C(n);for(l in r=f===Object.prototype?{}:Object.create(f),Pt.set(n,r),n)B(n,l)&&(r[l]=t(n[l]))}return r})(e),Pt=null,e}var we={}.toString;function St(e){return we.call(e).slice(8,-1)}var mn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Jr=typeof mn=="symbol"?function(e){var t;return e!=null&&(t=e[mn])&&t.apply(e)}:function(){return null};function Ot(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Gt={};function it(e){var t,n,r,o;if(arguments.length===1){if(S(e))return e.slice();if(this===Gt&&typeof e=="string")return[e];if(o=Jr(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Zr=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},_n=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Le=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(_n),us={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Qt(e,t){this.name=e,this.message=t}function Uo(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,o){return o.indexOf(n)===r}).join(`
`)}function Jn(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Uo(e,t)}function Jt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Uo(e,this.failures)}ue(Qt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ue(Jn).from(Qt),ue(Jt).from(Qt);var ei=Le.reduce(function(e,t){return e[t]=t+"Error",e},{}),ss=Qt,Y=Le.reduce(function(e,t){var n=t+"Error";function r(o,u){this.name=n,o?typeof o=="string"?(this.message="".concat(o).concat(u?`
 `+u:""),this.inner=u||null):typeof o=="object"&&(this.message="".concat(o.name," ").concat(o.message),this.inner=o):(this.message=us[t]||n,this.inner=null)}return ue(r).from(ss),e[t]=r,e},{});Y.Syntax=SyntaxError,Y.Type=TypeError,Y.Range=RangeError;var Yo=_n.reduce(function(e,t){return e[t+"Error"]=Y[t],e},{}),Zn=Le.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Y[t]),e},{});function re(){}function gn(e){return e}function ls(e,t){return e==null||e===gn?t:function(n){return t(e(n))}}function Tt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function cs(e,t){return e===re?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Tt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?Tt(o,this.onerror):o),u!==void 0?u:n}}function fs(e,t){return e===re?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Tt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Tt(r,this.onerror):r)}}function hs(e,t){return e===re?t:function(n){var r=e.apply(this,arguments);O(n,r);var o=this.onsuccess,u=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Tt(o,this.onsuccess):o),u&&(this.onerror=this.onerror?Tt(u,this.onerror):u),r===void 0?n===void 0?void 0:n:O(r,n)}}function ds(e,t){return e===re?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function ti(e,t){return e===re?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,u=new Array(o);o--;)u[o]=arguments[o];return n.then(function(){return t.apply(r,u)})}return t.apply(this,arguments)}}Zn.ModifyError=Jn,Zn.DexieError=Qt,Zn.BulkError=Jt;var $e=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ho(e){$e=e}var bn={},Vo=100,Ct=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,C(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,C(t),e]})(),_n=Ct[0],Le=Ct[1],Ct=Ct[2],Le=Le&&Le.then,At=_n&&_n.constructor,ni=!!Ct,wn=function(e,t){xn.push([e,t]),er&&(queueMicrotask(vs),er=!1)},ri=!0,er=!0,Dt=[],tr=[],ii=gn,ft={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:re,pgp:!1,env:{},finalize:re},z=ft,xn=[],Rt=0,nr=[];function M(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=z;if(typeof e!="function"){if(e!==bn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ai(this,this._value))}this._state=null,this._value=null,++t.ref,(function n(r,o){try{o(function(u){if(r._state===null){if(u===r)throw new TypeError("A promise cannot be resolved with itself.");var l=r._lib&&Zt();u&&typeof u.then=="function"?n(r,function(f,d){u instanceof M?u._then(f,d):u.then(f,d)}):(r._state=!0,r._value=u,$o(r)),l&&en()}},ai.bind(null,r))}catch(u){ai(r,u)}})(this,e)}var oi={get:function(){var e=z,t=ar;function n(r,o){var u=this,l=!e.global&&(e!==z||t!==ar),f=l&&!dt(),d=new M(function(p,b){ui(u,new Wo(Go(r,e,l,f),Go(o,e,l,f),p,b,e))});return this._consoleTask&&(d._consoleTask=this._consoleTask),d}return n.prototype=bn,n},set:function(e){Z(this,"then",e&&e.prototype===bn?oi:{get:function(){return e},set:oi.set})}};function Wo(e,t,n,r,o){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=o}function ai(e,t){var n,r;tr.push(t),e._state===null&&(n=e._lib&&Zt(),t=ii(t),e._state=!1,e._value=t,r=e,Dt.some(function(o){return o._value===r._value})||Dt.push(r),$o(e),n&&en())}function $o(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)ui(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),Rt===0&&(++Rt,wn(function(){--Rt==0&&si()},[]))}function ui(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Rt,wn(ps,[n,e,t])}else e._listeners.push(t)}function ps(e,t,n){try{var r,o=t._value;!t._state&&tr.length&&(tr=[]),r=$e&&t._consoleTask?t._consoleTask.run(function(){return e(o)}):e(o),t._state||tr.indexOf(o)!==-1||(function(u){for(var l=Dt.length;l;)if(Dt[--l]._value===u._value)return Dt.splice(l,1)})(t),n.resolve(r)}catch(u){n.reject(u)}finally{--Rt==0&&si(),--n.psd.ref||n.psd.finalize()}}function vs(){Kt(ft,function(){Zt()&&en()})}function Zt(){var e=ri;return er=ri=!1,e}function en(){var e,t,n;do for(;0<xn.length;)for(e=xn,xn=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<xn.length);er=ri=!0}function si(){var e=Dt;Dt=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=nr.slice(0),n=t.length;n;)t[--n]()}function rr(e){return new M(bn,!1,e)}function oe(e,t){var n=z;return function(){var r=Zt(),o=z;try{return pt(n,!0),e.apply(this,arguments)}catch(u){t&&t(u)}finally{pt(o,!1),r&&en()}}}q(M.prototype,{then:oi,_then:function(e,t){ui(this,new Wo(null,null,e,t,z))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:rr)(r)}):this.then(null,function(r){return(r&&r.name===t?n:rr)(r)})},finally:function(e){return this.then(function(t){return M.resolve(e()).then(function(){return t})},function(t){return M.resolve(e()).then(function(){return rr(t)})})},timeout:function(e,t){var n=this;return e<1/0?new M(function(r,o){var u=setTimeout(function(){return o(new Y.Timeout(t))},e);n.then(r,o).finally(clearTimeout.bind(null,u))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Z(M.prototype,Symbol.toStringTag,"Dexie.Promise"),ft.env=Xo(),q(M,{all:function(){var e=it.apply(null,arguments).map(ur);return new M(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(o,u){return M.resolve(o).then(function(l){e[u]=l,--r||t(e)},n)})})},resolve:function(e){return e instanceof M?e:e&&typeof e.then=="function"?new M(function(t,n){e.then(t,n)}):new M(bn,!0,e)},reject:rr,race:function(){var e=it.apply(null,arguments).map(ur);return new M(function(t,n){e.map(function(r){return M.resolve(r).then(t,n)})})},PSD:{get:function(){return z},set:function(e){return z=e}},totalEchoes:{get:function(){return ar}},newPSD:ht,usePSD:Kt,scheduler:{get:function(){return wn},set:function(e){wn=e}},rejectionMapper:{get:function(){return ii},set:function(e){ii=e}},follow:function(e,t){return new M(function(n,r){return ht(function(o,u){var l=z;l.unhandleds=[],l.onunhandled=u,l.finalize=Tt(function(){var f,d=this;f=function(){d.unhandleds.length===0?o():u(d.unhandleds[0])},nr.push(function p(){f(),nr.splice(nr.indexOf(p),1)}),++Rt,wn(function(){--Rt==0&&si()},[])},l.finalize),e()},t,n,r)})}}),At&&(At.allSettled&&Z(M,"allSettled",function(){var e=it.apply(null,arguments).map(ur);return new M(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(o,u){return M.resolve(o).then(function(l){return r[u]={status:"fulfilled",value:l}},function(l){return r[u]={status:"rejected",reason:l}}).then(function(){return--n||t(r)})})})}),At.any&&typeof AggregateError<"u"&&Z(M,"any",function(){var e=it.apply(null,arguments).map(ur);return new M(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,o=new Array(r);e.forEach(function(u,l){return M.resolve(u).then(function(f){return t(f)},function(f){o[l]=f,--r||n(new AggregateError(o))})})})}),At.withResolvers&&(M.withResolvers=At.withResolvers));var pe={awaits:0,echoes:0,id:0},ys=0,ir=[],or=0,ar=0,ms=0;function ht(e,t,n,r){var o=z,u=Object.create(o);return u.parent=o,u.ref=0,u.global=!1,u.id=++ms,ft.env,u.env=ni?{Promise:M,PromiseProp:{value:M,configurable:!0,writable:!0},all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject}:{},t&&O(u,t),++o.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()},r=Kt(u,e,n,r),u.ref===0&&u.finalize(),r}function tn(){return pe.id||(pe.id=++ys),++pe.awaits,pe.echoes+=Vo,pe.id}function dt(){return!!pe.awaits&&(--pe.awaits==0&&(pe.id=0),pe.echoes=pe.awaits*Vo,!0)}function ur(e){return pe.echoes&&e&&e.constructor===At?(tn(),e.then(function(t){return dt(),t},function(t){return dt(),le(t)})):e}function gs(){var e=ir[ir.length-1];ir.pop(),pt(e,!1)}function pt(e,t){var n,r=z;(t?!pe.echoes||or++&&e===z:!or||--or&&e===z)||queueMicrotask(t?(function(o){++ar,pe.echoes&&--pe.echoes!=0||(pe.echoes=pe.awaits=pe.id=0),ir.push(z),pt(o,!0)}).bind(null,e):gs),e!==z&&(z=e,r===ft&&(ft.env=Xo()),ni&&(n=ft.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(w,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Xo(){var e=w.Promise;return ni?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(w,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Kt(e,t,n,r,o){var u=z;try{return pt(e,!0),t(n,r,o)}finally{pt(u,!1)}}function Go(e,t,n,r){return typeof e!="function"?e:function(){var o=z;n&&tn(),pt(t,!0);try{return e.apply(this,arguments)}finally{pt(o,!1),r&&queueMicrotask(dt)}}}function li(e){Promise===At&&pe.echoes===0?or===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Le).indexOf("[native code]")===-1&&(tn=dt=re);var le=M.reject,It="\uFFFF",ot="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Qo="String expected.",nn=[],sr="__dbnames",ci="readonly",fi="readwrite";function jt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Jo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function lr(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=V(t))[e],t}}function Zo(){throw Y.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Q(e,t){try{var n=ea(e),r=ea(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return(function(o,u){for(var l=o.length,f=u.length,d=l<f?l:f,p=0;p<d;++p)if(o[p]!==u[p])return o[p]<u[p]?-1:1;return l===f?0:l<f?-1:1})(ta(e),ta(t));case"Array":return(function(o,u){for(var l=o.length,f=u.length,d=l<f?l:f,p=0;p<d;++p){var b=Q(o[p],u[p]);if(b!==0)return b}return l===f?0:l<f?-1:1})(e,t)}}catch{}return NaN}function ea(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=St(e),e==="ArrayBuffer"?"binary":e)}function ta(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function cr(e,t,n){var r=e.schema.yProps;return r?(t&&0<n.numFailures&&(t=t.filter(function(o,u){return!n.failures[u]})),Promise.all(r.map(function(o){return o=o.updatesTable,t?e.db.table(o).where("k").anyOf(t).delete():e.db.table(o).clear()})).then(function(){return n})):n}var En=(na.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(S(n))return g(g([],S(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var r=t.remove;if(S(r))return S(e)?e.filter(function(o){return!r.includes(o)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},na);function na(e){this["@@propmod"]=e}function ra(e,t){for(var n=P(t),r=n.length,o=!1,u=0;u<r;++u){var l=n[u],f=t[l],d=de(e,l);f instanceof En?(fe(e,l,f.execute(d)),o=!0):d!==f&&(fe(e,l,f),o=!0)}return o}var ia=(ie.prototype._trans=function(e,t,n){var r=this._tx||z.trans,o=this.name,u=$e&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function l(p,b,h){if(!h.schema[o])throw new Y.NotFound("Table "+o+" not part of transaction");return t(h.idbtrans,h)}var f=Zt();try{var d=r&&r.db._novip===this.db._novip?r===z.trans?r._promise(e,l,n):ht(function(){return r._promise(e,l,n)},{trans:r,transless:z.transless||z}):(function p(b,h,x,v){if(b.idbdb&&(b._state.openComplete||z.letThrough||b._vip)){var y=b._createTransaction(h,x,b._dbSchema);try{y.create(),b._state.PR1398_maxLoop=3}catch(m){return m.name===ei.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return p(b,h,x,v)})):le(m)}return y._promise(h,function(m,_){return ht(function(){return z.trans=y,v(m,_,y)})}).then(function(m){if(h==="readwrite")try{y.idbtrans.commit()}catch{}return h==="readonly"?m:y._completion.then(function(){return m})})}if(b._state.openComplete)return le(new Y.DatabaseClosed(b._state.dbOpenError));if(!b._state.isBeingOpened){if(!b._state.autoOpen)return le(new Y.DatabaseClosed);b.open().catch(re)}return b._state.dbReadyPromise.then(function(){return p(b,h,x,v)})})(this.db,e,[this.name],l);return u&&(d._consoleTask=u,d=d.catch(function(p){return console.trace(p),le(p)})),d}finally{f&&en()}},ie.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?le(new Y.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(o){return n.hook.reading.fire(o)})}).then(t)},ie.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(S(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=P(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(f){if(f.compound&&t.every(function(p){return 0<=f.keyPath.indexOf(p)})){for(var d=0;d<t.length;++d)if(t.indexOf(f.keyPath[d])===-1)return!1;return!0}return!1}).sort(function(f,d){return f.keyPath.length-d.keyPath.length})[0];if(n&&this.db._maxKey!==It){var u=n.keyPath.slice(0,t.length);return this.where(u).equals(u.map(function(d){return e[d]}))}!n&&$e&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName;function o(f,d){return Q(f,d)===0}var l=t.reduce(function(h,d){var p=h[0],b=h[1],h=r[d],x=e[d];return[p||h,p||!h?jt(b,h&&h.multi?function(v){return v=de(v,d),S(v)&&v.some(function(y){return o(x,y)})}:function(v){return o(x,de(v,d))}):b]},[null,null]),u=l[0],l=l[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(l):n?this.filter(l):this.where(t).equals("")},ie.prototype.filter=function(e){return this.toCollection().and(e)},ie.prototype.count=function(e){return this.toCollection().count(e)},ie.prototype.offset=function(e){return this.toCollection().offset(e)},ie.prototype.limit=function(e){return this.toCollection().limit(e)},ie.prototype.each=function(e){return this.toCollection().each(e)},ie.prototype.toArray=function(e){return this.toCollection().toArray(e)},ie.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ie.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,S(e)?"[".concat(e.join("+"),"]"):e))},ie.prototype.reverse=function(){return this.toCollection().reverse()},ie.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function o(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Zo&&((function(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Class extends value "+String(p)+" is not a constructor or null");function b(){this.constructor=d}s(d,p),d.prototype=p===null?Object.create(p):(b.prototype=p.prototype,new b)})(o,t=e),Object.defineProperty(o.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),o.prototype.table=function(){return r},e=o);for(var u=new Set,l=e.prototype;l;l=C(l))Object.getOwnPropertyNames(l).forEach(function(d){return u.add(d)});function f(d){if(!d)return d;var p,b=Object.create(e.prototype);for(p in d)if(!u.has(p))try{b[p]=d[p]}catch{}return b}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=f,this.hook("reading",f),e},ie.prototype.defineClass=function(){return this.mapToClass(function(e){O(this,e)})},ie.prototype.add=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,u=r.keyPath,l=e;return u&&o&&(l=lr(u)(e)),this._trans("readwrite",function(f){return n.core.mutate({trans:f,type:"add",keys:t!=null?[t]:null,values:[l]})}).then(function(f){return f.numFailures?M.reject(f.failures[0]):f.lastResult}).then(function(f){if(u)try{fe(e,u,f)}catch{}return f})},ie.prototype.upsert=function(e,t){var n=this,r=this.schema.primKey.keyPath;return this._trans("readwrite",function(o){return n.core.get({trans:o,key:e}).then(function(u){var l=u??{};return ra(l,t),r&&fe(l,r,e),n.core.mutate({trans:o,type:"put",values:[l],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(f){return f.numFailures?M.reject(f.failures[0]):!!u})})})},ie.prototype.update=function(e,t){return typeof e!="object"||S(e)?this.where(":id").equals(e).modify(t):(e=de(e,this.schema.primKey.keyPath),e===void 0?le(new Y.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},ie.prototype.put=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,u=r.keyPath,l=e;return u&&o&&(l=lr(u)(e)),this._trans("readwrite",function(f){return n.core.mutate({trans:f,type:"put",values:[l],keys:t!=null?[t]:null})}).then(function(f){return f.numFailures?M.reject(f.failures[0]):f.lastResult}).then(function(f){if(u)try{fe(e,u,f)}catch{}return f})},ie.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(r){return cr(t,[e],r)}).then(function(r){return r.numFailures?M.reject(r.failures[0]):void 0})})},ie.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Jo}).then(function(n){return cr(e,null,n)})}).then(function(t){return t.numFailures?M.reject(t.failures[0]):void 0})},ie.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(o){return t.hook.reading.fire(o)})})})},ie.prototype.bulkAdd=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,u=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(l){var p=r.schema.primKey,f=p.auto,p=p.keyPath;if(p&&o)throw new Y.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var d=e.length,p=p&&f?e.map(lr(p)):e;return r.core.mutate({trans:l,type:"add",keys:o,values:p,wantResults:u}).then(function(y){var h=y.numFailures,x=y.results,v=y.lastResult,y=y.failures;if(h===0)return u?x:v;throw new Jt("".concat(r.name,".bulkAdd(): ").concat(h," of ").concat(d," operations failed"),y)})})},ie.prototype.bulkPut=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,u=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(l){var p=r.schema.primKey,f=p.auto,p=p.keyPath;if(p&&o)throw new Y.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var d=e.length,p=p&&f?e.map(lr(p)):e;return r.core.mutate({trans:l,type:"put",keys:o,values:p,wantResults:u}).then(function(y){var h=y.numFailures,x=y.results,v=y.lastResult,y=y.failures;if(h===0)return u?x:v;throw new Jt("".concat(r.name,".bulkPut(): ").concat(h," of ").concat(d," operations failed"),y)})})},ie.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(l){return l.key}),o=e.map(function(l){return l.changes}),u=[];return this._trans("readwrite",function(l){return n.getMany({trans:l,keys:r,cache:"clone"}).then(function(f){var d=[],p=[];e.forEach(function(h,x){var v=h.key,y=h.changes,m=f[x];if(m){for(var _=0,E=Object.keys(y);_<E.length;_++){var k=E[_],T=y[k];if(k===t.schema.primKey.keyPath){if(Q(T,v)!==0)throw new Y.Constraint("Cannot update primary key in bulkUpdate()")}else fe(m,k,T)}u.push(x),d.push(v),p.push(m)}});var b=d.length;return n.mutate({trans:l,type:"put",keys:d,values:p,updates:{keys:r,changeSpecs:o}}).then(function(h){var x=h.numFailures,v=h.failures;if(x===0)return b;for(var y=0,m=Object.keys(v);y<m.length;y++){var _,E=m[y],k=u[Number(E)];k!=null&&(_=v[E],delete v[E],v[k]=_)}throw new Jt("".concat(t.name,".bulkUpdate(): ").concat(x," of ").concat(b," operations failed"),v)})})})},ie.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e}).then(function(o){return cr(t,e,o)})}).then(function(l){var o=l.numFailures,u=l.lastResult,l=l.failures;if(o===0)return u;throw new Jt("".concat(t.name,".bulkDelete(): ").concat(o," of ").concat(n," operations failed"),l)})},ie);function ie(){}function kn(e){function t(l,f){if(f){for(var d=arguments.length,p=new Array(d-1);--d;)p[d-1]=arguments[d];return n[l].subscribe.apply(null,p),e}if(typeof l=="string")return n[l]}var n={};t.addEventType=u;for(var r=1,o=arguments.length;r<o;++r)u(arguments[r]);return t;function u(l,f,d){if(typeof l!="object"){var p;f=f||ds;var b={subscribers:[],fire:d=d||re,subscribe:function(h){b.subscribers.indexOf(h)===-1&&(b.subscribers.push(h),b.fire=f(b.fire,h))},unsubscribe:function(h){b.subscribers=b.subscribers.filter(function(x){return x!==h}),b.fire=b.subscribers.reduce(f,d)}};return n[l]=t[l]=b}P(p=l).forEach(function(h){var x=p[h];if(S(x))u(h,p[h][0],p[h][1]);else{if(x!=="asap")throw new Y.InvalidArgument("Invalid event config");var v=u(h,gn,function(){for(var y=arguments.length,m=new Array(y);y--;)m[y]=arguments[y];v.subscribers.forEach(function(_){De(function(){_.apply(null,m)})})})}})}}function Pn(e,t){return ue(t).from({prototype:e}),t}function rn(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function hi(e,t){e.filter=jt(e.filter,t)}function di(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return jt(r(),t())}:t,e.justLimit=n&&!r}function fr(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Y.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function oa(e,t,n){var r=fr(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function hr(e,t,n,r){var o=e.replayFilter?jt(e.filter,e.replayFilter()):e.filter;if(e.or){var u={},l=function(f,d,p){var b,h;o&&!o(d,p,function(x){return d.stop(x)},function(x){return d.fail(x)})||((h=""+(b=d.primaryKey))=="[object ArrayBuffer]"&&(h=""+new Uint8Array(b)),B(u,h)||(u[h]=!0,t(f,d,p)))};return Promise.all([e.or._iterate(l,n),aa(oa(e,r,n),e.algorithm,l,!e.keysOnly&&e.valueMapper)])}return aa(oa(e,r,n),jt(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function aa(e,t,n,r){var o=oe(r?function(u,l,f){return n(r(u),l,f)}:n);return e.then(function(u){if(u)return u.start(function(){var l=function(){return u.continue()};t&&!t(u,function(f){return l=f},function(f){u.stop(f),l=re},function(f){u.fail(f),l=re})||o(u.value,u,function(f){return l=f}),l()})})}var bs=(ee.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,le.bind(null,n.error)):n.table._trans("readonly",e).then(t)},ee.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,le.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ee.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=jt(t.algorithm,e)},ee.prototype._iterate=function(e,t){return hr(this._ctx,e,t,this._ctx.table.core)},ee.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&O(n,e),t._ctx=n,t},ee.prototype.raw=function(){return this._ctx.valueMapper=null,this},ee.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return hr(t,e,n,t.table.core)})},ee.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,o=r.table.core;if(rn(r,!0))return o.count({trans:n,query:{index:fr(r,o.schema),range:r.range}}).then(function(l){return Math.min(l,r.limit)});var u=0;return hr(r,function(){return++u,!1},n,o).then(function(){return u})}).then(e)},ee.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],o=n.length-1;function u(d,p){return p?u(d[n[p]],p-1):d[r]}var l=this._ctx.dir==="next"?1:-1;function f(d,p){return Q(u(d,o),u(p,o))*l}return this.toArray(function(d){return d.sort(f)}).then(t)},ee.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&rn(r,!0)&&0<r.limit){var o=r.valueMapper,u=fr(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:u,range:r.range}}).then(function(f){return f=f.result,o?f.map(o):f})}var l=[];return hr(r,function(f){return l.push(f)},n,r.table.core).then(function(){return l})},e)},ee.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,rn(t)?di(t,function(){var n=e;return function(r,o){return n===0||(n===1?--n:o(function(){r.advance(n),n=0}),!1)}}):di(t,function(){var n=e;return function(){return--n<0}})),this},ee.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),di(this._ctx,function(){var t=e;return function(n,r,o){return--t<=0&&r(o),0<=t}},!0),this},ee.prototype.until=function(e,t){return hi(this._ctx,function(n,r,o){return!e(n.value)||(r(o),t)}),this},ee.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},ee.prototype.last=function(e){return this.reverse().first(e)},ee.prototype.filter=function(e){var t;return hi(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=jt(t.isMatch,e),this},ee.prototype.and=function(e){return this.filter(e)},ee.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ee.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ee.prototype.desc=function(){return this.reverse()},ee.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},ee.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ee.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},ee.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,o){n.push(o.key)}).then(function(){return n}).then(e)},ee.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&rn(t,!0)&&0<t.limit)return this._read(function(r){var o=fr(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:o,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,o){n.push(o.primaryKey)}).then(function(){return n}).then(e)},ee.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ee.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},ee.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ee.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return hi(this._ctx,function(o){var r=o.primaryKey.toString(),o=B(t,r);return t[r]=!0,!o}),this},ee.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var o=typeof e=="function"?e:function(m){return ra(m,e)},u=n.table.core,p=u.schema.primaryKey,l=p.outbound,f=p.extractKey,d=200,p=t.db._options.modifyChunkSize;p&&(d=typeof p=="object"?p[u.name]||p["*"]||200:p);function b(m,k){var E=k.failures,k=k.numFailures;x+=m-k;for(var T=0,A=P(E);T<A.length;T++){var R=A[T];h.push(E[R])}}var h=[],x=0,v=[],y=e===ua;return t.clone().primaryKeys().then(function(m){function _(k){var T=Math.min(d,m.length-k),A=m.slice(k,k+T);return(y?Promise.resolve([]):u.getMany({trans:r,keys:A,cache:"immutable"})).then(function(R){var j=[],D=[],K=l?[]:null,N=y?A:[];if(!y)for(var I=0;I<T;++I){var F=R[I],$={value:V(F),primKey:m[k+I]};o.call($,$.value,$)!==!1&&($.value==null?N.push(m[k+I]):l||Q(f(F),f($.value))===0?(D.push($.value),l&&K.push(m[k+I])):(N.push(m[k+I]),j.push($.value)))}return Promise.resolve(0<j.length&&u.mutate({trans:r,type:"add",values:j}).then(function(X){for(var G in X.failures)N.splice(parseInt(G),1);b(j.length,X)})).then(function(){return(0<D.length||E&&typeof e=="object")&&u.mutate({trans:r,type:"put",keys:K,values:D,criteria:E,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<k}).then(function(X){return b(D.length,X)})}).then(function(){return(0<N.length||E&&y)&&u.mutate({trans:r,type:"delete",keys:N,criteria:E,isAdditionalChunk:0<k}).then(function(X){return cr(n.table,N,X)}).then(function(X){return b(N.length,X)})}).then(function(){return m.length>k+T&&_(k+d)})})}var E=rn(n)&&n.limit===1/0&&(typeof e!="function"||y)&&{index:n.index,range:n.range};return _(0).then(function(){if(0<h.length)throw new Jn("Error modifying one or more objects",h,x,v);return m.length})})})},ee.prototype.delete=function(){var e=this._ctx,t=e.range;return!rn(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(ua):this._write(function(n){var r=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then(function(u){return e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then(function(d){var f=d.failures,d=d.numFailures;if(d)throw new Jn("Could not delete some values",Object.keys(f).map(function(p){return f[p]}),u-d);return u-d})})})},ee);function ee(){}var ua=function(e,t){return t.value=null};function _s(e,t){return e<t?-1:e===t?0:1}function ws(e,t){return t<e?-1:e===t?0:1}function Be(e,t,n){return e=e instanceof la?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function on(e){return new e.Collection(e,function(){return sa("")}).limit(0)}function dr(e,t,n,r){var o,u,l,f,d,p,b,h=n.length;if(!n.every(function(y){return typeof y=="string"}))return Be(e,Qo);function x(y){o=y==="next"?function(_){return _.toUpperCase()}:function(_){return _.toLowerCase()},u=y==="next"?function(_){return _.toLowerCase()}:function(_){return _.toUpperCase()},l=y==="next"?_s:ws;var m=n.map(function(_){return{lower:u(_),upper:o(_)}}).sort(function(_,E){return l(_.lower,E.lower)});f=m.map(function(_){return _.upper}),d=m.map(function(_){return _.lower}),b=(p=y)==="next"?"":r}x("next"),e=new e.Collection(e,function(){return vt(f[0],d[h-1]+r)}),e._ondirectionchange=function(y){x(y)};var v=0;return e._addAlgorithm(function(y,m,_){var E=y.key;if(typeof E!="string")return!1;var k=u(E);if(t(k,d,v))return!0;for(var T=null,A=v;A<h;++A){var R=(function(j,D,K,N,I,F){for(var $=Math.min(j.length,N.length),X=-1,G=0;G<$;++G){var qe=D[G];if(qe!==N[G])return I(j[G],K[G])<0?j.substr(0,G)+K[G]+K.substr(G+1):I(j[G],N[G])<0?j.substr(0,G)+N[G]+K.substr(G+1):0<=X?j.substr(0,X)+D[X]+K.substr(X+1):null;I(j[G],qe)<0&&(X=G)}return $<N.length&&F==="next"?j+K.substr(j.length):$<j.length&&F==="prev"?j.substr(0,K.length):X<0?null:j.substr(0,X)+N[X]+K.substr(X+1)})(E,k,f[A],d[A],l,p);R===null&&T===null?v=A+1:(T===null||0<l(T,R))&&(T=R)}return m(T!==null?function(){y.continue(T+b)}:_),!1}),e}function vt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function sa(e){return{type:1,lower:e,upper:e}}var la=(Object.defineProperty(ve.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ve.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?on(this):new this.Collection(this,function(){return vt(e,t,!n,!r)})}catch{return Be(this,ot)}},ve.prototype.equals=function(e){return e==null?Be(this,ot):new this.Collection(this,function(){return sa(e)})},ve.prototype.above=function(e){return e==null?Be(this,ot):new this.Collection(this,function(){return vt(e,void 0,!0)})},ve.prototype.aboveOrEqual=function(e){return e==null?Be(this,ot):new this.Collection(this,function(){return vt(e,void 0,!1)})},ve.prototype.below=function(e){return e==null?Be(this,ot):new this.Collection(this,function(){return vt(void 0,e,!1,!0)})},ve.prototype.belowOrEqual=function(e){return e==null?Be(this,ot):new this.Collection(this,function(){return vt(void 0,e)})},ve.prototype.startsWith=function(e){return typeof e!="string"?Be(this,Qo):this.between(e,e+It,!0,!0)},ve.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):dr(this,function(t,n){return t.indexOf(n[0])===0},[e],It)},ve.prototype.equalsIgnoreCase=function(e){return dr(this,function(t,n){return t===n[0]},[e],"")},ve.prototype.anyOfIgnoreCase=function(){var e=it.apply(Gt,arguments);return e.length===0?on(this):dr(this,function(t,n){return n.indexOf(t)!==-1},e,"")},ve.prototype.startsWithAnyOfIgnoreCase=function(){var e=it.apply(Gt,arguments);return e.length===0?on(this):dr(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,It)},ve.prototype.anyOf=function(){var e=this,t=it.apply(Gt,arguments),n=this._cmp;try{t.sort(n)}catch{return Be(this,ot)}if(t.length===0)return on(this);var r=new this.Collection(this,function(){return vt(t[0],t[t.length-1])});r._ondirectionchange=function(u){n=u==="next"?e._ascending:e._descending,t.sort(n)};var o=0;return r._addAlgorithm(function(u,l,f){for(var d=u.key;0<n(d,t[o]);)if(++o===t.length)return l(f),!1;return n(d,t[o])===0||(l(function(){u.continue(t[o])}),!1)}),r},ve.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ve.prototype.noneOf=function(){var e=it.apply(Gt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Be(this,ot)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},ve.prototype.inAnyRange=function(E,t){var n=this,r=this._cmp,o=this._ascending,u=this._descending,l=this._min,f=this._max;if(E.length===0)return on(this);if(!E.every(function(k){return k[0]!==void 0&&k[1]!==void 0&&o(k[0],k[1])<=0}))return Be(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Y.InvalidArgument);var d=!t||t.includeLowers!==!1,p=t&&t.includeUppers===!0,b,h=o;function x(k,T){return h(k[0],T[0])}try{(b=E.reduce(function(k,T){for(var A=0,R=k.length;A<R;++A){var j=k[A];if(r(T[0],j[1])<0&&0<r(T[1],j[0])){j[0]=l(j[0],T[0]),j[1]=f(j[1],T[1]);break}}return A===R&&k.push(T),k},[])).sort(x)}catch{return Be(this,ot)}var v=0,y=p?function(k){return 0<o(k,b[v][1])}:function(k){return 0<=o(k,b[v][1])},m=d?function(k){return 0<u(k,b[v][0])}:function(k){return 0<=u(k,b[v][0])},_=y,E=new this.Collection(this,function(){return vt(b[0][0],b[b.length-1][1],!d,!p)});return E._ondirectionchange=function(k){h=k==="next"?(_=y,o):(_=m,u),b.sort(x)},E._addAlgorithm(function(k,T,A){for(var R,j=k.key;_(j);)if(++v===b.length)return T(A),!1;return!y(R=j)&&!m(R)||(n._cmp(j,b[v][1])===0||n._cmp(j,b[v][0])===0||T(function(){h===o?k.continue(b[v][0]):k.continue(b[v][1])}),!1)}),E},ve.prototype.startsWithAnyOf=function(){var e=it.apply(Gt,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?on(this):this.inAnyRange(e.map(function(t){return[t,t+It]})):Be(this,"startsWithAnyOf() only works with strings")},ve);function ve(){}function Xe(e){return oe(function(t){return Sn(t),e(t.target.error),!1})}function Sn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var On="storagemutated",pi="x-storagemutated-1",yt=kn(null,On),xs=(Ge.prototype._lock=function(){return _e(!z.global),++this._reculock,this._reculock!==1||z.global||(z.lockOwnerFor=this),this},Ge.prototype._unlock=function(){if(_e(!z.global),--this._reculock==0)for(z.global||(z.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Kt(e[1],e[0])}catch{}}return this},Ge.prototype._locked=function(){return this._reculock&&z.lockOwnerFor!==this},Ge.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(_e(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new Y.DatabaseClosed(r);case"MissingAPIError":throw new Y.MissingAPI(r.message,r);default:throw new Y.OpenFailed(r)}if(!this.active)throw new Y.TransactionInactive;return _e(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=oe(function(o){Sn(o),t._reject(e.error)}),e.onabort=oe(function(o){Sn(o),t.active&&t._reject(new Y.Abort(e.error)),t.active=!1,t.on("abort").fire(o)}),e.oncomplete=oe(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&yt.storagemutated.fire(e.mutatedParts)}),this},Ge.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return le(new Y.ReadOnly("Transaction is readonly"));if(!this.active)return le(new Y.TransactionInactive);if(this._locked())return new M(function(u,l){r._blockedFuncs.push([function(){r._promise(e,t,n).then(u,l)},z])});if(n)return ht(function(){var u=new M(function(l,f){r._lock();var d=t(l,f,r);d&&d.then&&d.then(l,f)});return u.finally(function(){return r._unlock()}),u._lib=!0,u});var o=new M(function(u,l){var f=t(u,l,r);f&&f.then&&f.then(u,l)});return o._lib=!0,o},Ge.prototype._root=function(){return this.parent?this.parent._root():this},Ge.prototype.waitFor=function(e){var t,n=this._root(),r=M.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),(function u(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=u)})());var o=n._waitingFor;return new M(function(u,l){r.then(function(f){return n._waitingQueue.push(oe(u.bind(null,f)))},function(f){return n._waitingQueue.push(oe(l.bind(null,f)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},Ge.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Y.Abort))},Ge.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(B(t,e))return t[e];var n=this.schema[e];if(!n)throw new Y.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},Ge);function Ge(){}function vi(e,t,n,r,o,u,l,f){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:u,src:(n&&!l?"&":"")+(r?"*":"")+(o?"++":"")+ca(t),type:f}}function ca(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function yi(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(o){return[o.name,o]},n.reduce(function(o,u,l){return l=r(u,l),l&&(o[l[0]]=l[1]),o},{}))};var r}var Tn=function(e){try{return e.only([[]]),Tn=function(){return[[]]},[[]]}catch{return Tn=function(){return It},It}};function mi(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return de(n,t)}:function(n){return de(n,e)};var t}function fa(e){return[].slice.call(e)}var Es=0;function Cn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function ks(e,t,d){function r(_){if(_.type===3)return null;if(_.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var v=_.lower,y=_.upper,m=_.lowerOpen,_=_.upperOpen;return v===void 0?y===void 0?null:t.upperBound(y,!!_):y===void 0?t.lowerBound(v,!!m):t.bound(v,y,!!m,!!_)}function o(x){var v,y=x.name;return{name:y,schema:x,mutate:function(m){var _=m.trans,E=m.type,k=m.keys,T=m.values,A=m.range;return new Promise(function(R,j){R=oe(R);var D=_.objectStore(y),K=D.keyPath==null,N=E==="put"||E==="add";if(!N&&E!=="delete"&&E!=="deleteRange")throw new Error("Invalid operation type: "+E);var I,F=(k||T||{length:1}).length;if(k&&T&&k.length!==T.length)throw new Error("Given keys array must have same length as given values array.");if(F===0)return R({numFailures:0,failures:{},results:[],lastResult:void 0});function $(Se){++qe,Sn(Se)}var X=[],G=[],qe=0;if(E==="deleteRange"){if(A.type===4)return R({numFailures:qe,failures:G,results:[],lastResult:void 0});A.type===3?X.push(I=D.clear()):X.push(I=D.delete(r(A)))}else{var K=N?K?[T,k]:[T,null]:[k,null],W=K[0],Ee=K[1];if(N)for(var ke=0;ke<F;++ke)X.push(I=Ee&&Ee[ke]!==void 0?D[E](W[ke],Ee[ke]):D[E](W[ke])),I.onerror=$;else for(ke=0;ke<F;++ke)X.push(I=D[E](W[ke])),I.onerror=$}function Pr(Se){Se=Se.target.result,X.forEach(function(Bt,ji){return Bt.error!=null&&(G[ji]=Bt.error)}),R({numFailures:qe,failures:G,results:E==="delete"?k:X.map(function(Bt){return Bt.result}),lastResult:Se})}I.onerror=function(Se){$(Se),Pr(Se)},I.onsuccess=Pr})},getMany:function(m){var _=m.trans,E=m.keys;return new Promise(function(k,T){k=oe(k);for(var A,R=_.objectStore(y),j=E.length,D=new Array(j),K=0,N=0,I=function(X){X=X.target,D[X._pos]=X.result,++N===K&&k(D)},F=Xe(T),$=0;$<j;++$)E[$]!=null&&((A=R.get(E[$]))._pos=$,A.onsuccess=I,A.onerror=F,++K);K===0&&k(D)})},get:function(m){var _=m.trans,E=m.key;return new Promise(function(k,T){k=oe(k);var A=_.objectStore(y).get(E);A.onsuccess=function(R){return k(R.target.result)},A.onerror=Xe(T)})},query:(v=p,function(m){return new Promise(function(_,E){_=oe(_);var k,T,A,K=m.trans,R=m.values,j=m.limit,I=m.query,D=j===1/0?void 0:j,N=I.index,I=I.range,K=K.objectStore(y),N=N.isPrimaryKey?K:K.index(N.name),I=r(I);if(j===0)return _({result:[]});v?((D=R?N.getAll(I,D):N.getAllKeys(I,D)).onsuccess=function(F){return _({result:F.target.result})},D.onerror=Xe(E)):(k=0,T=!R&&"openKeyCursor"in N?N.openKeyCursor(I):N.openCursor(I),A=[],T.onsuccess=function(F){var $=T.result;return $?(A.push(R?$.value:$.primaryKey),++k===j?_({result:A}):void $.continue()):_({result:A})},T.onerror=Xe(E))})}),openCursor:function(m){var _=m.trans,E=m.values,k=m.query,T=m.reverse,A=m.unique;return new Promise(function(R,j){R=oe(R);var N=k.index,D=k.range,K=_.objectStore(y),K=N.isPrimaryKey?K:K.index(N.name),N=T?A?"prevunique":"prev":A?"nextunique":"next",I=!E&&"openKeyCursor"in K?K.openKeyCursor(r(D),N):K.openCursor(r(D),N);I.onerror=Xe(j),I.onsuccess=oe(function(F){var $,X,G,qe,W=I.result;W?(W.___id=++Es,W.done=!1,$=W.continue.bind(W),X=(X=W.continuePrimaryKey)&&X.bind(W),G=W.advance.bind(W),qe=function(){throw new Error("Cursor not stopped")},W.trans=_,W.stop=W.continue=W.continuePrimaryKey=W.advance=function(){throw new Error("Cursor not started")},W.fail=oe(j),W.next=function(){var Ee=this,ke=1;return this.start(function(){return ke--?Ee.continue():Ee.stop()}).then(function(){return Ee})},W.start=function(Ee){function ke(){if(I.result)try{Ee()}catch(Se){W.fail(Se)}else W.done=!0,W.start=function(){throw new Error("Cursor behind last entry")},W.stop()}var Pr=new Promise(function(Se,Bt){Se=oe(Se),I.onerror=Xe(Bt),W.fail=Bt,W.stop=function(ji){W.stop=W.continue=W.continuePrimaryKey=W.advance=qe,Se(ji)}});return I.onsuccess=oe(function(Se){I.onsuccess=ke,ke()}),W.continue=$,W.continuePrimaryKey=X,W.advance=G,ke(),Pr},R(W)):R(null)},j)})},count:function(m){var _=m.query,E=m.trans,k=_.index,T=_.range;return new Promise(function(A,R){var j=E.objectStore(y),D=k.isPrimaryKey?j:j.index(k.name),j=r(T),D=j?D.count(j):D.count();D.onsuccess=oe(function(K){return A(K.target.result)}),D.onerror=Xe(R)})}}}var u,l,f,b=(l=d,f=fa((u=e).objectStoreNames),{schema:{name:u.name,tables:f.map(function(x){return l.objectStore(x)}).map(function(x){var v=x.keyPath,_=x.autoIncrement,y=S(v),m={},_={name:x.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:v==null,compound:y,keyPath:v,autoIncrement:_,unique:!0,extractKey:mi(v)},indexes:fa(x.indexNames).map(function(E){return x.index(E)}).map(function(A){var k=A.name,T=A.unique,R=A.multiEntry,A=A.keyPath,R={name:k,compound:S(A),keyPath:A,unique:T,multiEntry:R,extractKey:mi(A)};return m[Cn(A)]=R}),getIndexByKeyPath:function(E){return m[Cn(E)]}};return m[":id"]=_.primaryKey,v!=null&&(m[Cn(v)]=_.primaryKey),_})},hasGetAll:0<f.length&&"getAll"in l.objectStore(f[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),d=b.schema,p=b.hasGetAll,b=d.tables.map(o),h={};return b.forEach(function(x){return h[x.name]=x}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(x){if(!h[x])throw new Error("Table '".concat(x,"' not found"));return h[x]},MIN_KEY:-1/0,MAX_KEY:Tn(t),schema:d}}function Ps(e,t,n,r){var o=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=ks(t,o,r),e.dbcore.reduce(function(u,l){return l=l.create,c(c({},u),l(u))},r))}}function pr(e,r){var n=r.db,r=Ps(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(o){var u=o.name;e.core.schema.tables.some(function(l){return l.name===u})&&(o.core=e.core.table(u),e[u]instanceof e.Table&&(e[u].core=o.core))})}function vr(e,t,n,r){n.forEach(function(o){var u=r[o];t.forEach(function(l){var f=(function d(p,b){return Ne(p,b)||(p=C(p))&&d(p,b)})(l,o);(!f||"value"in f&&f.value===void 0)&&(l===e.Transaction.prototype||l instanceof e.Transaction?Z(l,o,{get:function(){return this.table(o)},set:function(d){H(this,o,{value:d,writable:!0,configurable:!0,enumerable:!0})}}):l[o]=new e.Table(o,u))})})}function gi(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function Ss(e,t){return e._cfg.version-t._cfg.version}function Os(e,t,n,r){var o=e._dbSchema;n.objectStoreNames.contains("$meta")&&!o.$meta&&(o.$meta=yi("$meta",da("")[0],[]),e._storeNames.push("$meta"));var u=e._createTransaction("readwrite",e._storeNames,o);u.create(n),u._completion.catch(r);var l=u._reject.bind(u),f=z.transless||z;ht(function(){return z.trans=u,z.transless=f,t!==0?(pr(e,n),p=t,((d=u).storeNames.includes("$meta")?d.table("$meta").get("version").then(function(b){return b??p}):M.resolve(p)).then(function(b){return x=b,v=u,y=n,m=[],b=(h=e)._versions,_=h._dbSchema=mr(0,h.idbdb,y),(b=b.filter(function(E){return E._cfg.version>=x})).length!==0?(b.forEach(function(E){m.push(function(){var k=_,T=E._cfg.dbschema;gr(h,k,y),gr(h,T,y),_=h._dbSchema=T;var A=bi(k,T);A.add.forEach(function(N){_i(y,N[0],N[1].primKey,N[1].indexes)}),A.change.forEach(function(N){if(N.recreate)throw new Y.Upgrade("Not yet support for changing primary key");var I=y.objectStore(N.name);N.add.forEach(function(F){return yr(I,F)}),N.change.forEach(function(F){I.deleteIndex(F.name),yr(I,F)}),N.del.forEach(function(F){return I.deleteIndex(F)})});var R=E._cfg.contentUpgrade;if(R&&E._cfg.version>x){pr(h,y),v._memoizedTables={};var j=Xt(T);A.del.forEach(function(N){j[N]=k[N]}),gi(h,[h.Transaction.prototype]),vr(h,[h.Transaction.prototype],P(j),j),v.schema=j;var D,K=Zr(R);return K&&tn(),A=M.follow(function(){var N;(D=R(v))&&K&&(N=dt.bind(null,null),D.then(N,N))}),D&&typeof D.then=="function"?M.resolve(D):A.then(function(){return D})}}),m.push(function(k){var T,A,R=E._cfg.dbschema;T=R,A=k,[].slice.call(A.db.objectStoreNames).forEach(function(j){return T[j]==null&&A.db.deleteObjectStore(j)}),gi(h,[h.Transaction.prototype]),vr(h,[h.Transaction.prototype],h._storeNames,h._dbSchema),v.schema=h._dbSchema}),m.push(function(k){h.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(h.idbdb.version/10)===E._cfg.version?(h.idbdb.deleteObjectStore("$meta"),delete h._dbSchema.$meta,h._storeNames=h._storeNames.filter(function(T){return T!=="$meta"})):k.objectStore("$meta").put(E._cfg.version,"version"))})}),(function E(){return m.length?M.resolve(m.shift()(v.idbtrans)).then(E):M.resolve()})().then(function(){ha(_,y)})):M.resolve();var h,x,v,y,m,_}).catch(l)):(P(o).forEach(function(b){_i(n,b,o[b].primKey,o[b].indexes)}),pr(e,n),void M.follow(function(){return e.on.populate.fire(u)}).catch(l));var d,p})}function Ts(e,t){ha(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=mr(0,e.idbdb,t);gr(e,e._dbSchema,t);for(var r=0,o=bi(n,e._dbSchema).change;r<o.length;r++){var u=(function(l){if(l.change.length||l.recreate)return console.warn("Unable to patch indexes of table ".concat(l.name," because it has changes on the type of index or primary key.")),{value:void 0};var f=t.objectStore(l.name);l.add.forEach(function(d){$e&&console.debug("Dexie upgrade patch: Creating missing index ".concat(l.name,".").concat(d.src)),yr(f,d)})})(o[r]);if(typeof u=="object")return u.value}}function bi(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var o=e[n],u=t[n];if(o){var l={name:n,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||o.primKey.auto!==u.primKey.auto)l.recreate=!0,r.change.push(l);else{var f=o.idxByName,d=u.idxByName,p=void 0;for(p in f)d[p]||l.del.push(p);for(p in d){var b=f[p],h=d[p];b?b.src!==h.src&&l.change.push(h):l.add.push(h)}(0<l.del.length||0<l.add.length||0<l.change.length)&&r.change.push(l)}}else r.add.push([n,u])}return r}function _i(e,t,n,r){var o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(u){return yr(o,u)}),o}function ha(e,t){P(e).forEach(function(n){t.db.objectStoreNames.contains(n)||($e&&console.debug("Dexie: Creating missing table",n),_i(t,n,e[n].primKey,e[n].indexes))})}function yr(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function mr(e,t,n){var r={};return Ae(t.objectStoreNames,0).forEach(function(o){for(var u=n.objectStore(o),l=vi(ca(p=u.keyPath),p||"",!0,!1,!!u.autoIncrement,p&&typeof p!="string",!0),f=[],d=0;d<u.indexNames.length;++d){var b=u.index(u.indexNames[d]),p=b.keyPath,b=vi(b.name,p,!!b.unique,!!b.multiEntry,!1,p&&typeof p!="string",!1);f.push(b)}r[o]=yi(o,l,f)}),r}function gr(e,t,n){for(var r=n.db.objectStoreNames,o=0;o<r.length;++o){var u=r[o],l=n.objectStore(u);e._hasGetAll="getAll"in l;for(var f=0;f<l.indexNames.length;++f){var d=l.indexNames[f],p=l.index(d).keyPath,b=typeof p=="string"?p:"["+Ae(p).join("+")+"]";!t[u]||(p=t[u].idxByName[b])&&(p.name=d,delete t[u].idxByName[b],t[u].idxByName[d]=p)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&w.WorkerGlobalScope&&w instanceof w.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function da(e){return e.split(",").map(function(t,n){var u=t.split(":"),r=(o=u[1])===null||o===void 0?void 0:o.trim(),o=(t=u[0].trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(o)?o.match(/^\[(.*)\]$/)[1].split("+"):o;return vi(o,u||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),S(u),n===0,r)})}var Cs=(an.prototype._createTableSchema=yi,an.prototype._parseIndexSyntax=da,an.prototype._parseStoresSpec=function(e,t){var n=this;P(e).forEach(function(r){if(e[r]!==null){var o=n._parseIndexSyntax(e[r]),u=o.shift();if(!u)throw new Y.Schema("Invalid schema for table "+r+": "+e[r]);if(u.unique=!0,u.multi)throw new Y.Schema("Primary key cannot be multiEntry*");o.forEach(function(l){if(l.auto)throw new Y.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new Y.Schema("Index must have a name and cannot be an empty string")}),o=n._createTableSchema(r,u,o),t[r]=o}})},an.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?O(this._cfg.storesSource,n):n;var n=t._versions,r={},o={};return n.forEach(function(u){O(r,u._cfg.storesSource),o=u._cfg.dbschema={},u._parseStoresSpec(r,o)}),t._dbSchema=o,gi(t,[t._allTables,t,t.Transaction.prototype]),vr(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],P(o),o),t._storeNames=P(o),this},an.prototype.upgrade=function(e){return this._cfg.contentUpgrade=ti(this._cfg.contentUpgrade||re,e),this},an);function an(){}function wi(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new at(sr,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function xi(e){return e&&typeof e.databases=="function"}function Ei(e){return ht(function(){return z.letThrough=!0,e()})}function ki(e){return!("from"in e)}var xe=function(e,t){if(!this){var n=new xe;return e&&"d"in e&&O(n,e),n}O(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function An(e,t,n){var r=Q(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(ki(e))return O(e,{from:t,to:n,d:1});var o=e.l,r=e.r;if(Q(n,e.from)<0)return o?An(o,t,n):e.l={from:t,to:n,d:1,l:null,r:null},va(e);if(0<Q(t,e.to))return r?An(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},va(e);Q(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<Q(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,o&&!e.l&&Dn(e,o),r&&n&&Dn(e,r)}}function Dn(e,t){ki(t)||(function n(r,d){var u=d.from,l=d.to,f=d.l,d=d.r;An(r,u,l),f&&n(r,f),d&&n(r,d)})(e,t)}function pa(e,t){var n=br(t),r=n.next();if(r.done)return!1;for(var o=r.value,u=br(e),l=u.next(o.from),f=l.value;!r.done&&!l.done;){if(Q(f.from,o.to)<=0&&0<=Q(f.to,o.from))return!0;Q(o.from,f.from)<0?o=(r=n.next(f.from)).value:f=(l=u.next(o.from)).value}return!1}function br(e){var t=ki(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&Q(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||Q(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function va(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),o=1<r?"r":r<-1?"l":"";o&&(t=o=="r"?"l":"r",n=c({},e),r=e[o],e.from=r.from,e.to=r.to,e[o]=r[o],n[o]=r[t],(e[t]=n).d=ya(n)),e.d=ya(e)}function ya(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function _r(e,t){return P(t).forEach(function(n){e[n]?Dn(e[n],t[n]):e[n]=(function r(o){var u,l,f={};for(u in o)B(o,u)&&(l=o[u],f[u]=!l||typeof l!="object"||Qn.has(l.constructor)?l:r(l));return f})(t[n])}),e}function Pi(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&pa(t[n],e[n])})}q(xe.prototype,((Le={add:function(e){return Dn(this,e),this},addKey:function(e){return An(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return An(t,n,n)}),this},hasKey:function(e){var t=br(this).next(e).value;return t&&Q(t.from,e)<=0&&0<=Q(t.to,e)}})[mn]=function(){return br(this)},Le));var Nt={},Si={},Oi=!1;function wr(e){_r(Si,e),Oi||(Oi=!0,setTimeout(function(){Oi=!1,Ti(Si,!(Si={}))},0))}function Ti(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,o=Object.values(Nt);r<o.length;r++)ma(l=o[r],e,n,t);else for(var u in e){var l,f=/^idb\:\/\/(.*)\/(.*)\//.exec(u);f&&(u=f[1],f=f[2],(l=Nt["idb://".concat(u,"/").concat(f)])&&ma(l,e,n,t))}n.forEach(function(d){return d()})}function ma(e,t,n,r){for(var o=[],u=0,l=Object.entries(e.queries.query);u<l.length;u++){for(var f=l[u],d=f[0],p=[],b=0,h=f[1];b<h.length;b++){var x=h[b];Pi(t,x.obsSet)?x.subscribers.forEach(function(_){return n.add(_)}):r&&p.push(x)}r&&o.push([d,p])}if(r)for(var v=0,y=o;v<y.length;v++){var m=y[v],d=m[0],p=m[1];e.queries.query[d]=p}}function As(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?le(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,o=Math.round(10*e.verno),u=!1;function l(){if(t.openCanceller!==r)throw new Y.DatabaseClosed("db.open() was cancelled")}function f(){return new M(function(x,v){if(l(),!n)throw new Y.MissingAPI;var y=e.name,m=t.autoSchema||!o?n.open(y):n.open(y,o);if(!m)throw new Y.MissingAPI;m.onerror=Xe(v),m.onblocked=oe(e._fireOnBlocked),m.onupgradeneeded=oe(function(_){var E;b=m.transaction,t.autoSchema&&!e._options.allowEmptyDB?(m.onerror=Sn,b.abort(),m.result.close(),(E=n.deleteDatabase(y)).onsuccess=E.onerror=oe(function(){v(new Y.NoSuchDatabase("Database ".concat(y," doesnt exist")))})):(b.onerror=Xe(v),_=_.oldVersion>Math.pow(2,62)?0:_.oldVersion,h=_<1,e.idbdb=m.result,u&&Ts(e,b),Os(e,_/10,b,v))},v),m.onsuccess=oe(function(){b=null;var _,E,k,T,A,R=e.idbdb=m.result,j=Ae(R.objectStoreNames);if(0<j.length)try{var D=R.transaction((T=j).length===1?T[0]:T,"readonly");if(t.autoSchema)E=R,k=D,(_=e).verno=E.version/10,k=_._dbSchema=mr(0,E,k),_._storeNames=Ae(E.objectStoreNames,0),vr(_,[_._allTables],P(k),k);else if(gr(e,e._dbSchema,D),((A=bi(mr(0,(A=e).idbdb,D),A._dbSchema)).add.length||A.change.some(function(K){return K.add.length||K.change.length}))&&!u)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),R.close(),o=R.version+1,u=!0,x(f());pr(e,D)}catch{}nn.push(e),R.onversionchange=oe(function(K){t.vcFired=!0,e.on("versionchange").fire(K)}),R.onclose=oe(function(){e.close({disableAutoOpen:!1})}),h&&(A=e._deps,D=y,R=A.indexedDB,A=A.IDBKeyRange,xi(R)||D===sr||wi(R,A).put({name:D}).catch(re)),x()},v)}).catch(function(x){switch(x?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),f();break;case"VersionError":if(0<o)return o=0,f()}return M.reject(x)})}var d,p=t.dbReadyResolve,b=null,h=!1;return M.race([r,(typeof navigator>"u"?M.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(x){function v(){return indexedDB.databases().finally(x)}d=setInterval(v,100),v()}).finally(function(){return clearInterval(d)}):Promise.resolve()).then(f)]).then(function(){return l(),t.onReadyBeingFired=[],M.resolve(Ei(function(){return e.on.ready.fire(e.vip)})).then(function x(){if(0<t.onReadyBeingFired.length){var v=t.onReadyBeingFired.reduce(ti,re);return t.onReadyBeingFired=[],M.resolve(Ei(function(){return v(e.vip)})).then(x)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(x){t.dbOpenError=x;try{b&&b.abort()}catch{}return r===t.openCanceller&&e._close(),le(x)}).finally(function(){t.openComplete=!0,p()}).then(function(){var x;return h&&(x={},e.tables.forEach(function(v){v.schema.indexes.forEach(function(y){y.name&&(x["idb://".concat(e.name,"/").concat(v.name,"/").concat(y.name)]=new xe(-1/0,[[[]]]))}),x["idb://".concat(e.name,"/").concat(v.name,"/")]=x["idb://".concat(e.name,"/").concat(v.name,"/:dels")]=new xe(-1/0,[[[]]])}),yt(On).fire(x),Ti(x,!0)),e})}function Ci(e){function t(u){return e.next(u)}var n=o(t),r=o(function(u){return e.throw(u)});function o(u){return function(d){var f=u(d),d=f.value;return f.done?d:d&&typeof d.then=="function"?d.then(n,r):S(d)?Promise.all(d).then(n,r):n(d)}}return o(t)()}function xr(e,t,n){for(var r=S(e)?e.slice():[e],o=0;o<n;++o)r.push(t);return r}var Ds={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return c(c({},e),{table:function(t){var n=e.table(t),r=n.schema,o={},u=[];function l(h,x,v){var y=Cn(h),m=o[y]=o[y]||[],_=h==null?0:typeof h=="string"?1:h.length,E=0<x,E=c(c({},v),{name:E?"".concat(y,"(virtual-from:").concat(v.name,")"):v.name,lowLevelIndex:v,isVirtual:E,keyTail:x,keyLength:_,extractKey:mi(h),unique:!E&&v.unique});return m.push(E),E.isPrimaryKey||u.push(E),1<_&&l(_===2?h[0]:h.slice(0,_-1),x+1,v),m.sort(function(k,T){return k.keyTail-T.keyTail}),E}t=l(r.primaryKey.keyPath,0,r.primaryKey),o[":id"]=[t];for(var f=0,d=r.indexes;f<d.length;f++){var p=d[f];l(p.keyPath,0,p)}function b(h){var x,v=h.query.index;return v.isVirtual?c(c({},h),{query:{index:v.lowLevelIndex,range:(x=h.query.range,v=v.keyTail,{type:x.type===1?2:x.type,lower:xr(x.lower,x.lowerOpen?e.MAX_KEY:e.MIN_KEY,v),lowerOpen:!0,upper:xr(x.upper,x.upperOpen?e.MIN_KEY:e.MAX_KEY,v),upperOpen:!0})}}):h}return c(c({},n),{schema:c(c({},r),{primaryKey:t,indexes:u,getIndexByKeyPath:function(h){return(h=o[Cn(h)])&&h[0]}}),count:function(h){return n.count(b(h))},query:function(h){return n.query(b(h))},openCursor:function(h){var x=h.query.index,v=x.keyTail,y=x.isVirtual,m=x.keyLength;return y?n.openCursor(b(h)).then(function(E){return E&&_(E)}):n.openCursor(h);function _(E){return Object.create(E,{continue:{value:function(k){k!=null?E.continue(xr(k,h.reverse?e.MAX_KEY:e.MIN_KEY,v)):h.unique?E.continue(E.key.slice(0,m).concat(h.reverse?e.MIN_KEY:e.MAX_KEY,v)):E.continue()}},continuePrimaryKey:{value:function(k,T){E.continuePrimaryKey(xr(k,e.MAX_KEY,v),T)}},primaryKey:{get:function(){return E.primaryKey}},key:{get:function(){var k=E.key;return m===1?k[0]:k.slice(0,m)}},value:{get:function(){return E.value}}})}}})}})}};function Ai(e,t,n,r){return n=n||{},r=r||"",P(e).forEach(function(o){var u,l,f;B(t,o)?(u=e[o],l=t[o],typeof u=="object"&&typeof l=="object"&&u&&l?(f=St(u))!==St(l)?n[r+o]=t[o]:f==="Object"?Ai(u,l,n,r+o+"."):u!==l&&(n[r+o]=t[o]):u!==l&&(n[r+o]=t[o])):n[r+o]=void 0}),P(t).forEach(function(o){B(e,o)||(n[r+o]=t[o])}),n}function Di(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Rs={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return c(c({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return c(c({},n),{mutate:function(o){var u=z.trans,l=u.table(t).hook,f=l.deleting,d=l.creating,p=l.updating;switch(o.type){case"add":if(d.fire===re)break;return u._promise("readwrite",function(){return b(o)},!0);case"put":if(d.fire===re&&p.fire===re)break;return u._promise("readwrite",function(){return b(o)},!0);case"delete":if(f.fire===re)break;return u._promise("readwrite",function(){return b(o)},!0);case"deleteRange":if(f.fire===re)break;return u._promise("readwrite",function(){return(function h(x,v,y){return n.query({trans:x,values:!1,query:{index:r,range:v},limit:y}).then(function(m){var _=m.result;return b({type:"delete",keys:_,trans:x}).then(function(E){return 0<E.numFailures?Promise.reject(E.failures[0]):_.length<y?{failures:[],numFailures:0,lastResult:void 0}:h(x,c(c({},v),{lower:_[_.length-1],lowerOpen:!0}),y)})})})(o.trans,o.range,1e4)},!0)}return n.mutate(o);function b(h){var x,v,y,m=z.trans,_=h.keys||Di(r,h);if(!_)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?c(c({},h),{keys:_}):c({},h)).type!=="delete"&&(h.values=g([],h.values)),h.keys&&(h.keys=g([],h.keys)),x=n,y=_,((v=h).type==="add"?Promise.resolve([]):x.getMany({trans:v.trans,keys:y,cache:"immutable"})).then(function(E){var k=_.map(function(T,A){var R,j,D,K=E[A],N={onerror:null,onsuccess:null};return h.type==="delete"?f.fire.call(N,T,K,m):h.type==="add"||K===void 0?(R=d.fire.call(N,T,h.values[A],m),T==null&&R!=null&&(h.keys[A]=T=R,r.outbound||fe(h.values[A],r.keyPath,T))):(R=Ai(K,h.values[A]),(j=p.fire.call(N,R,T,K,m))&&(D=h.values[A],Object.keys(j).forEach(function(I){B(D,I)?D[I]=j[I]:fe(D,I,j[I])}))),N});return n.mutate(h).then(function(T){for(var A=T.failures,R=T.results,j=T.numFailures,T=T.lastResult,D=0;D<_.length;++D){var K=(R||_)[D],N=k[D];K==null?N.onerror&&N.onerror(A[D]):N.onsuccess&&N.onsuccess(h.type==="put"&&E[D]?h.values[D]:K)}return{failures:A,results:R,numFailures:j,lastResult:T}}).catch(function(T){return k.forEach(function(A){return A.onerror&&A.onerror(T)}),Promise.reject(T)})})}}})}})}};function ga(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],o=0,u=0;o<t.keys.length&&u<e.length;++o)Q(t.keys[o],e[u])===0&&(r.push(n?V(t.values[o]):t.values[o]),++u);return r.length===e.length?r:null}catch{return null}}var Ks={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return c(c({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var o=ga(r.keys,r.trans._cache,r.cache==="clone");return o?M.resolve(o):n.getMany(r).then(function(u){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?V(u):u},u})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function ba(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function _a(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Is={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new xe(e.MIN_KEY,e.MAX_KEY);return c(c({},e),{transaction:function(r,o,u){if(z.subscr&&o!=="readonly")throw new Y.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(z.querier));return e.transaction(r,o,u)},table:function(r){var o=e.table(r),u=o.schema,l=u.primaryKey,h=u.indexes,f=l.extractKey,d=l.outbound,p=l.autoIncrement&&h.filter(function(v){return v.compound&&v.keyPath.includes(l.keyPath)}),b=c(c({},o),{mutate:function(v){function y(I){return I="idb://".concat(t,"/").concat(r,"/").concat(I),T[I]||(T[I]=new xe)}var m,_,E,k=v.trans,T=v.mutatedParts||(v.mutatedParts={}),A=y(""),R=y(":dels"),j=v.type,N=v.type==="deleteRange"?[v.range]:v.type==="delete"?[v.keys]:v.values.length<50?[Di(l,v).filter(function(I){return I}),v.values]:[],D=N[0],K=N[1],N=v.trans._cache;return S(D)?(A.addKeys(D),(N=j==="delete"||D.length===K.length?ga(D,N):null)||R.addKeys(D),(N||K)&&(m=y,_=N,E=K,u.indexes.forEach(function(I){var F=m(I.name||"");function $(G){return G!=null?I.extractKey(G):null}function X(G){return I.multiEntry&&S(G)?G.forEach(function(qe){return F.addKey(qe)}):F.addKey(G)}(_||E).forEach(function(G,Ee){var W=_&&$(_[Ee]),Ee=E&&$(E[Ee]);Q(W,Ee)!==0&&(W!=null&&X(W),Ee!=null&&X(Ee))})}))):D?(K={from:(K=D.lower)!==null&&K!==void 0?K:e.MIN_KEY,to:(K=D.upper)!==null&&K!==void 0?K:e.MAX_KEY},R.add(K),A.add(K)):(A.add(n),R.add(n),u.indexes.forEach(function(I){return y(I.name).add(n)})),o.mutate(v).then(function(I){return!D||v.type!=="add"&&v.type!=="put"||(A.addKeys(I.results),p&&p.forEach(function(F){for(var $=v.values.map(function(W){return F.extractKey(W)}),X=F.keyPath.findIndex(function(W){return W===l.keyPath}),G=0,qe=I.results.length;G<qe;++G)$[G][X]=I.results[G];y(F.name).addKeys($)})),k.mutatedParts=_r(k.mutatedParts||{},T),I})}}),h=function(y){var m=y.query,y=m.index,m=m.range;return[y,new xe((y=m.lower)!==null&&y!==void 0?y:e.MIN_KEY,(m=m.upper)!==null&&m!==void 0?m:e.MAX_KEY)]},x={get:function(v){return[l,new xe(v.key)]},getMany:function(v){return[l,new xe().addKeys(v.keys)]},count:h,query:h,openCursor:h};return P(x).forEach(function(v){b[v]=function(y){var m=z.subscr,_=!!m,E=ba(z,o)&&_a(v,y)?y.obsSet={}:m;if(_){var k=function(K){return K="idb://".concat(t,"/").concat(r,"/").concat(K),E[K]||(E[K]=new xe)},T=k(""),A=k(":dels"),m=x[v](y),_=m[0],m=m[1];if((v==="query"&&_.isPrimaryKey&&!y.values?A:k(_.name||"")).add(m),!_.isPrimaryKey){if(v!=="count"){var R=v==="query"&&d&&y.values&&o.query(c(c({},y),{values:!1}));return o[v].apply(this,arguments).then(function(K){if(v==="query"){if(d&&y.values)return R.then(function($){return $=$.result,T.addKeys($),K});var N=y.values?K.result.map(f):K.result;(y.values?T:A).addKeys(N)}else if(v==="openCursor"){var I=K,F=y.values;return I&&Object.create(I,{key:{get:function(){return A.addKey(I.primaryKey),I.key}},primaryKey:{get:function(){var $=I.primaryKey;return A.addKey($),$}},value:{get:function(){return F&&T.addKey(I.primaryKey),I.value}}})}return K})}A.add(n)}}return o[v].apply(this,arguments)}}),b}})}};function wa(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=c({},t),S(t.keys)&&(t.keys=t.keys.filter(function(o,u){return!(u in n.failures)})),"values"in t&&S(t.values)&&(t.values=t.values.filter(function(o,u){return!(u in n.failures)})),t)}function Ri(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<Q(n,r.lower):0<=Q(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?Q(e,t.upper)<0:Q(e,t.upper)<=0));var n,r}function xa(e,t,x,r,o,u){if(!x||x.length===0)return e;var l=t.query.index,f=l.multiEntry,d=t.query.range,p=r.schema.primaryKey.extractKey,b=l.extractKey,h=(l.lowLevelIndex||l).extractKey,x=x.reduce(function(v,y){var m=v,_=[];if(y.type==="add"||y.type==="put")for(var E=new xe,k=y.values.length-1;0<=k;--k){var T,A=y.values[k],R=p(A);E.hasKey(R)||(T=b(A),(f&&S(T)?T.some(function(I){return Ri(I,d)}):Ri(T,d))&&(E.addKey(R),_.push(A)))}switch(y.type){case"add":var j=new xe().addKeys(t.values?v.map(function(F){return p(F)}):v),m=v.concat(t.values?_.filter(function(F){return F=p(F),!j.hasKey(F)&&(j.addKey(F),!0)}):_.map(function(F){return p(F)}).filter(function(F){return!j.hasKey(F)&&(j.addKey(F),!0)}));break;case"put":var D=new xe().addKeys(y.values.map(function(F){return p(F)}));m=v.filter(function(F){return!D.hasKey(t.values?p(F):F)}).concat(t.values?_:_.map(function(F){return p(F)}));break;case"delete":var K=new xe().addKeys(y.keys);m=v.filter(function(F){return!K.hasKey(t.values?p(F):F)});break;case"deleteRange":var N=y.range;m=v.filter(function(F){return!Ri(p(F),N)})}return m},e);return x===e?e:(x.sort(function(v,y){return Q(h(v),h(y))||Q(p(v),p(y))}),t.limit&&t.limit<1/0&&(x.length>t.limit?x.length=t.limit:e.length===t.limit&&x.length<t.limit&&(o.dirty=!0)),u?Object.freeze(x):x)}function Ea(e,t){return Q(e.lower,t.lower)===0&&Q(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function js(e,t){return(function(n,r,o,u){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=Q(n,r))===0){if(o&&u)return 0;if(o)return 1;if(u)return-1}return r})(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=(function(n,r,o,u){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=Q(n,r))===0){if(o&&u)return 0;if(o)return-1;if(u)return 1}return r})(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Ns(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var o,u;e.subscribers.delete(n),e.subscribers.size===0&&(o=e,u=t,setTimeout(function(){o.subscribers.size===0&&Ot(u,o)},3e3))})}var Ms={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return c(c({},e),{transaction:function(n,r,o){var u,l,f=e.transaction(n,r,o);return r==="readwrite"&&(l=(u=new AbortController).signal,o=function(d){return function(){if(u.abort(),r==="readwrite"){for(var p=new Set,b=0,h=n;b<h.length;b++){var x=h[b],v=Nt["idb://".concat(t,"/").concat(x)];if(v){var y=e.table(x),m=v.optimisticOps.filter(function(F){return F.trans===f});if(f._explicit&&d&&f.mutatedParts)for(var _=0,E=Object.values(v.queries.query);_<E.length;_++)for(var k=0,T=(j=E[_]).slice();k<T.length;k++)Pi((D=T[k]).obsSet,f.mutatedParts)&&(Ot(j,D),D.subscribers.forEach(function(F){return p.add(F)}));else if(0<m.length){v.optimisticOps=v.optimisticOps.filter(function(F){return F.trans!==f});for(var A=0,R=Object.values(v.queries.query);A<R.length;A++)for(var j,D,K,N=0,I=(j=R[A]).slice();N<I.length;N++)(D=I[N]).res!=null&&f.mutatedParts&&(d&&!D.dirty?(K=Object.isFrozen(D.res),K=xa(D.res,D.req,m,y,D,K),D.dirty?(Ot(j,D),D.subscribers.forEach(function(F){return p.add(F)})):K!==D.res&&(D.res=K,D.promise=M.resolve({result:K}))):(D.dirty&&Ot(j,D),D.subscribers.forEach(function(F){return p.add(F)})))}}}p.forEach(function(F){return F()})}}},f.addEventListener("abort",o(!1),{signal:l}),f.addEventListener("error",o(!1),{signal:l}),f.addEventListener("complete",o(!0),{signal:l})),f},table:function(n){var r=e.table(n),o=r.schema.primaryKey;return c(c({},r),{mutate:function(u){var l=z.trans;if(o.outbound||l.db._options.cache==="disabled"||l.explicit||l.idbtrans.mode!=="readwrite")return r.mutate(u);var f=Nt["idb://".concat(t,"/").concat(n)];return f?(l=r.mutate(u),u.type!=="add"&&u.type!=="put"||!(50<=u.values.length||Di(o,u).some(function(d){return d==null}))?(f.optimisticOps.push(u),u.mutatedParts&&wr(u.mutatedParts),l.then(function(d){0<d.numFailures&&(Ot(f.optimisticOps,u),(d=wa(0,u,d))&&f.optimisticOps.push(d),u.mutatedParts&&wr(u.mutatedParts))}),l.catch(function(){Ot(f.optimisticOps,u),u.mutatedParts&&wr(u.mutatedParts)})):l.then(function(d){var p=wa(0,c(c({},u),{values:u.values.map(function(b,h){var x;return d.failures[h]?b:(b=(x=o.keyPath)!==null&&x!==void 0&&x.includes(".")?V(b):c({},b),fe(b,o.keyPath,d.results[h]),b)})}),d);f.optimisticOps.push(p),queueMicrotask(function(){return u.mutatedParts&&wr(u.mutatedParts)})}),l):r.mutate(u)},query:function(u){if(!ba(z,r)||!_a("query",u))return r.query(u);var l=((p=z.trans)===null||p===void 0?void 0:p.db._options.cache)==="immutable",h=z,f=h.requery,d=h.signal,p=(function(y,m,_,E){var k=Nt["idb://".concat(y,"/").concat(m)];if(!k)return[];if(!(m=k.queries[_]))return[null,!1,k,null];var T=m[(E.query?E.query.index.name:null)||""];if(!T)return[null,!1,k,null];switch(_){case"query":var A=T.find(function(R){return R.req.limit===E.limit&&R.req.values===E.values&&Ea(R.req.query.range,E.query.range)});return A?[A,!0,k,T]:[T.find(function(R){return("limit"in R.req?R.req.limit:1/0)>=E.limit&&(!E.values||R.req.values)&&js(R.req.query.range,E.query.range)}),!1,k,T];case"count":return A=T.find(function(R){return Ea(R.req.query.range,E.query.range)}),[A,!!A,k,T]}})(t,n,"query",u),b=p[0],h=p[1],x=p[2],v=p[3];return b&&h?b.obsSet=u.obsSet:(h=r.query(u).then(function(y){var m=y.result;if(b&&(b.res=m),l){for(var _=0,E=m.length;_<E;++_)Object.freeze(m[_]);Object.freeze(m)}else y.result=V(m);return y}).catch(function(y){return v&&b&&Ot(v,b),Promise.reject(y)}),b={obsSet:u.obsSet,promise:h,subscribers:new Set,type:"query",req:u,dirty:!1},v?v.push(b):(v=[b],(x=x||(Nt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[u.query.index.name||""]=v)),Ns(b,v,f,d),b.promise.then(function(y){return{result:xa(y.result,u,x?.optimisticOps,r,b,l)}})}})}})}};function Er(e,t){return new Proxy(e,{get:function(n,r,o){return r==="db"?t:Reflect.get(n,r,o)}})}var at=(ce.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Y.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Y.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Ss),n.stores({}),this._state.autoSchema=!1,n)},ce.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||z.letThrough||this._vip)?e():new M(function(n,r){if(t._state.openComplete)return r(new Y.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new Y.DatabaseClosed);t.open().catch(re)}t._state.dbReadyPromise.then(n,r)}).then(e)},ce.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,o=e.name;return o&&this.unuse({stack:t,name:o}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:o}),e.sort(function(u,l){return u.level-l.level}),this},ce.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(o){return r?o.create!==r:!!n&&o.name!==n})),this},ce.prototype.open=function(){var e=this;return Kt(ft,function(){return As(e)})},ce.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=nn.indexOf(this);if(0<=t&&nn.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new M(function(n){e.dbReadyResolve=n}),e.openCanceller=new M(function(n,r){e.cancelOpen=r}))},ce.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new Y.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new Y.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},ce.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new M(function(o,u){function l(){t.close(e);var f=t._deps.indexedDB.deleteDatabase(t.name);f.onsuccess=oe(function(){var d,p,b;d=t._deps,p=t.name,b=d.indexedDB,d=d.IDBKeyRange,xi(b)||p===sr||wi(b,d).delete(p).catch(re),o()}),f.onerror=Xe(u),f.onblocked=t._fireOnBlocked}if(n)throw new Y.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(l):l()})},ce.prototype.backendDB=function(){return this.idbdb},ce.prototype.isOpen=function(){return this.idbdb!==null},ce.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ce.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ce.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ce.prototype,"tables",{get:function(){var e=this;return P(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ce.prototype.transaction=function(){var e=(function(t,n,r){var o=arguments.length;if(o<2)throw new Y.InvalidArgument("Too few arguments");for(var u=new Array(o-1);--o;)u[o-1]=arguments[o];return r=u.pop(),[t,yn(u),r]}).apply(this,arguments);return this._transaction.apply(this,e)},ce.prototype._transaction=function(e,t,n){var r=this,o=z.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);var u,l,f=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(l=t.map(function(p){if(p=p instanceof r.Table?p.name:p,typeof p!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return p}),e=="r"||e===ci)u=ci;else{if(e!="rw"&&e!=fi)throw new Y.InvalidArgument("Invalid transaction mode: "+e);u=fi}if(o){if(o.mode===ci&&u===fi){if(!f)throw new Y.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&l.forEach(function(p){if(o&&o.storeNames.indexOf(p)===-1){if(!f)throw new Y.SubTransaction("Table "+p+" not included in parent transaction.");o=null}}),f&&o&&!o.active&&(o=null)}}catch(p){return o?o._promise(null,function(b,h){h(p)}):le(p)}var d=(function p(b,h,x,v,y){return M.resolve().then(function(){var m=z.transless||z,_=b._createTransaction(h,x,b._dbSchema,v);if(_.explicit=!0,m={trans:_,transless:m},v)_.idbtrans=v.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,b._state.PR1398_maxLoop=3}catch(T){return T.name===ei.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return p(b,h,x,null,y)})):le(T)}var E,k=Zr(y);return k&&tn(),m=M.follow(function(){var T;(E=y.call(_,_))&&(k?(T=dt.bind(null,null),E.then(T,T)):typeof E.next=="function"&&typeof E.throw=="function"&&(E=Ci(E)))},m),(E&&typeof E.then=="function"?M.resolve(E).then(function(T){return _.active?T:le(new Y.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):m.then(function(){return E})).then(function(T){return v&&_._resolve(),_._completion.then(function(){return T})}).catch(function(T){return _._reject(T),le(T)})})}).bind(null,this,u,l,o,n);return o?o._promise(u,d,"lock"):z.trans?Kt(z.transless,function(){return r._whenReady(d)}):this._whenReady(d)},ce.prototype.table=function(e){if(!B(this._allTables,e))throw new Y.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ce);function ce(e,t){var n=this;this._middlewares={},this.verno=0;var r=ce.dependencies;this._options=t=c({addons:ce.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o,u,l,f,d,p={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:re,dbReadyPromise:null,cancelOpen:re,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};p.dbReadyPromise=new M(function(h){p.dbReadyResolve=h}),p.openCanceller=new M(function(h,x){p.cancelOpen=x}),this._state=p,this.name=e,this.on=kn(this,"populate","blocked","versionchange","close",{ready:[ti,re]}),this.once=function(h,x){var v=function(){for(var y=[],m=0;m<arguments.length;m++)y[m]=arguments[m];n.on(h).unsubscribe(v),x.apply(n,y)};return n.on(h,v)},this.on.ready.subscribe=se(this.on.ready.subscribe,function(h){return function(x,v){ce.vip(function(){var y,m=n._state;m.openComplete?(m.dbOpenError||M.resolve().then(x),v&&h(x)):m.onReadyBeingFired?(m.onReadyBeingFired.push(x),v&&h(x)):(h(x),y=n,v||h(function _(){y.on.ready.unsubscribe(x),y.on.ready.unsubscribe(_)}))})}}),this.Collection=(o=this,Pn(bs.prototype,function(E,_){this.db=o;var v=Jo,y=null;if(_)try{v=_()}catch(k){y=k}var m=E._ctx,_=m.table,E=_.hook.reading.fire;this._ctx={table:_,index:m.index,isPrimKey:!m.index||_.schema.primKey.keyPath&&m.index===_.schema.primKey.name,range:v,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:y,or:m.or,valueMapper:E!==gn?E:null}})),this.Table=(u=this,Pn(ia.prototype,function(h,x,v){this.db=u,this._tx=v,this.name=h,this.schema=x,this.hook=u._allTables[h]?u._allTables[h].hook:kn(null,{creating:[cs,re],reading:[ls,gn],updating:[hs,re],deleting:[fs,re]})})),this.Transaction=(l=this,Pn(xs.prototype,function(h,x,v,y,m){var _=this;h!=="readonly"&&x.forEach(function(E){E=(E=v[E])===null||E===void 0?void 0:E.yProps,E&&(x=x.concat(E.map(function(k){return k.updatesTable})))}),this.db=l,this.mode=h,this.storeNames=x,this.schema=v,this.chromeTransactionDurability=y,this.idbtrans=null,this.on=kn(this,"complete","error","abort"),this.parent=m||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new M(function(E,k){_._resolve=E,_._reject=k}),this._completion.then(function(){_.active=!1,_.on.complete.fire()},function(E){var k=_.active;return _.active=!1,_.on.error.fire(E),_.parent?_.parent._reject(E):k&&_.idbtrans&&_.idbtrans.abort(),le(E)})})),this.Version=(f=this,Pn(Cs.prototype,function(h){this.db=f,this._cfg={version:h,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(d=this,Pn(la.prototype,function(h,x,v){if(this.db=d,this._ctx={table:h,index:x===":id"?null:x,or:v},this._cmp=this._ascending=Q,this._descending=function(y,m){return Q(m,y)},this._max=function(y,m){return 0<Q(y,m)?y:m},this._min=function(y,m){return Q(y,m)<0?y:m},this._IDBKeyRange=d._deps.IDBKeyRange,!this._IDBKeyRange)throw new Y.MissingAPI})),this.on("versionchange",function(h){0<h.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(h){!h.newVersion||h.newVersion<h.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(h.oldVersion/10))}),this._maxKey=Tn(t.IDBKeyRange),this._createTransaction=function(h,x,v,y){return new n.Transaction(h,x,v,n._options.chromeTransactionDurability,y)},this._fireOnBlocked=function(h){n.on("blocked").fire(h),nn.filter(function(x){return x.name===n.name&&x!==n&&!x._state.vcFired}).map(function(x){return x.on("versionchange").fire(h)})},this.use(Ks),this.use(Ms),this.use(Is),this.use(Ds),this.use(Rs);var b=new Proxy(this,{get:function(h,x,v){if(x==="_vip")return!0;if(x==="table")return function(m){return Er(n.table(m),b)};var y=Reflect.get(h,x,v);return y instanceof ia?Er(y,b):x==="tables"?y.map(function(m){return Er(m,b)}):x==="_createTransaction"?function(){return Er(y.apply(this,arguments),b)}:y}});this.vip=b,r.forEach(function(h){return h(n)})}var kr,Le=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Bs=(Ki.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},Ki.prototype[Le]=function(){return this},Ki);function Ki(e){this._subscribe=e}try{kr={indexedDB:w.indexedDB||w.mozIndexedDB||w.webkitIndexedDB||w.msIndexedDB,IDBKeyRange:w.IDBKeyRange||w.webkitIDBKeyRange}}catch{kr={indexedDB:null,IDBKeyRange:null}}function ka(e){var t,n=!1,r=new Bs(function(o){var u=Zr(e),l,f=!1,d={},p={},b={get closed(){return f},unsubscribe:function(){f||(f=!0,l&&l.abort(),h&&yt.storagemutated.unsubscribe(v))}};o.start&&o.start(b);var h=!1,x=function(){return li(y)},v=function(m){_r(d,m),Pi(p,d)&&x()},y=function(){var m,_,E;!f&&kr.indexedDB&&(d={},m={},l&&l.abort(),l=new AbortController,E=(function(k){var T=Zt();try{u&&tn();var A=ht(e,k);return A=u?A.finally(dt):A}finally{T&&en()}})(_={subscr:m,signal:l.signal,requery:x,querier:e,trans:null}),Promise.resolve(E).then(function(k){n=!0,t=k,f||_.signal.aborted||(d={},(function(T){for(var A in T)if(B(T,A))return;return 1})(p=m)||h||(yt(On,v),h=!0),li(function(){return!f&&o.next&&o.next(k)}))},function(k){n=!1,["DatabaseClosedError","AbortError"].includes(k?.name)||f||li(function(){f||o.error&&o.error(k)})}))};return setTimeout(x,0),b});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var Mt=at;function Ii(e){var t=mt;try{mt=!0,yt.storagemutated.fire(e),Ti(e,!0)}finally{mt=t}}q(Mt,c(c({},Zn),{delete:function(e){return new Mt(e,{addons:[]}).delete()},exists:function(e){return new Mt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Mt.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(xi(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(o){return o.name}).filter(function(o){return o!==sr})}):wi(n,t).toCollection().primaryKeys()).then(e)}catch{return le(new Y.MissingAPI)}var t,n},defineClass:function(){return function(e){O(this,e)}},ignoreTransaction:function(e){return z.trans?Kt(z.transless,e):e()},vip:Ei,async:function(e){return function(){try{var t=Ci(e.apply(this,arguments));return t&&typeof t.then=="function"?t:M.resolve(t)}catch(n){return le(n)}}},spawn:function(e,t,n){try{var r=Ci(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:M.resolve(r)}catch(o){return le(o)}},currentTransaction:{get:function(){return z.trans||null}},waitFor:function(e,t){return t=M.resolve(typeof e=="function"?Mt.ignoreTransaction(e):e).timeout(t||6e4),z.trans?z.trans.waitFor(t):t},Promise:M,debug:{get:function(){return $e},set:function(e){Ho(e)}},derive:ue,extend:O,props:q,override:se,Events:kn,on:yt,liveQuery:ka,extendObservabilitySet:_r,getByKeyPath:de,setByKeyPath:fe,delByKeyPath:function(e,t){typeof t=="string"?fe(e,t,void 0):"length"in t&&[].map.call(t,function(n){fe(e,n,void 0)})},shallowClone:Xt,deepClone:V,getObjectDiff:Ai,cmp:Q,asap:De,minKey:-1/0,addons:[],connections:nn,errnames:ei,dependencies:kr,cache:Nt,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),Mt.maxKey=Tn(Mt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(yt(On,function(e){mt||(e=new CustomEvent(pi,{detail:e}),mt=!0,dispatchEvent(e),mt=!1)}),addEventListener(pi,function(e){e=e.detail,mt||Ii(e)}));var un,mt=!1,Pa=function(){};return typeof BroadcastChannel<"u"&&((Pa=function(){(un=new BroadcastChannel(pi)).onmessage=function(e){return e.data&&Ii(e.data)}})(),typeof un.unref=="function"&&un.unref(),yt(On,function(e){mt||un.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!at.disableBfCache&&e.persisted){$e&&console.debug("Dexie: handling persisted pagehide"),un?.close();for(var t=0,n=nn;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!at.disableBfCache&&e.persisted&&($e&&console.debug("Dexie: handling persisted pageshow"),Pa(),Ii({all:new xe(-1/0,[[]])}))})),M.rejectionMapper=function(e,t){return!e||e instanceof Qt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Yo[e.name]?e:(t=new Yo[e.name](t||e.message,e),"stack"in e&&Z(t,"stack",{get:function(){return this.inner.stack}}),t)},Ho($e),c(at,Object.freeze({__proto__:null,Dexie:at,liveQuery:ka,Entity:Zo,cmp:Q,PropModification:En,replacePrefix:function(e,t){return new En({replacePrefix:[e,t]})},add:function(e){return new En({add:e})},remove:function(e){return new En({remove:e})},default:at,RangeSet:xe,mergeRanges:Dn,rangesOverlap:pa}),{default:at}),at})})(Yn)),Yn.exports}var Hu=Yu();const Wr=zu(Hu),Ko=Symbol.for("Dexie"),Hn=globalThis[Ko]||(globalThis[Ko]=Wr);if(Wr.semVer!==Hn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Wr.semVer} and ${Hn.semVer}`);const{liveQuery:qs,mergeRanges:Fs,rangesOverlap:Ls,RangeSet:zs,cmp:Us,Entity:Ys,PropModification:Hs,replacePrefix:Vs,add:Ws,remove:$s,DexieYProvider:Xs}=Hn;class Vu extends Hn{notes;layout;buttonLayout;constructor(){super("CrystalSkullDB"),this.version(1).stores({notes:"++id, content, updatedAt",layout:"++id, x, y, width, height, visible, minimized",buttonLayout:"++id, x, y"})}}const Ce=new Vu,Io="cs_migrated_to_dexie";function Wu(){try{return typeof chrome<"u"&&!!chrome.runtime?.id}catch{return!1}}function $u(){try{return localStorage.getItem(Io)==="true"}catch{return!1}}function Xu(){try{localStorage.setItem(Io,"true")}catch(i){console.warn("Failed to set migration flag:",i)}}async function Gu(){if(!$u()&&Wu())try{const i=await new Promise((a,s)=>{chrome.storage.sync.get(["content","layout","buttonLayout"],c=>{if(chrome.runtime?.lastError){s(chrome.runtime.lastError);return}a(c)})});await Ce.transaction("rw",Ce.notes,Ce.layout,Ce.buttonLayout,async()=>{i.content!==void 0&&await Ce.notes.put({id:1,content:i.content,updatedAt:Date.now()}),i.layout!==void 0&&await Ce.layout.put({id:1,...i.layout}),i.buttonLayout!==void 0&&await Ce.buttonLayout.put({id:1,...i.buttonLayout})}).catch(a=>{throw console.error("Migration transaction failed:",a),a}),Xu();try{await chrome.storage.sync.remove(["content","layout","buttonLayout"])}catch(a){console.warn("Failed to clear chrome.storage.sync after migration:",a)}}catch(i){console.warn("Migration from chrome.storage.sync failed:",i)}}let vn=null;function Et(){try{return typeof location<"u"&&location.protocol==="chrome-extension:"}catch{return!1}}async function Wt(i,a){return await new Promise((s,c)=>{try{chrome.runtime.sendMessage({type:i,payload:a},g=>{const w=chrome.runtime?.lastError;if(w){c(w);return}s(g)})}catch(g){c(g)}})}async function $t(){return vn||(vn=(async()=>{try{Et()&&(await Ce.open(),await Gu())}catch(i){throw console.warn("Failed to initialize Dexie database:",i),vn=null,i}})(),vn)}async function Qu(){try{return await $t(),Et()?(await Ce.notes.get(1))?.content||"":(await Wt("storage:getNote"))?.content??""}catch(i){console.error("[Storage] Failed to load note:",i);try{return localStorage.getItem("cs_note")||""}catch{return""}}}async function Ju(i){try{await $t(),Et()?await Ce.notes.put({id:1,content:i,updatedAt:Date.now()}):await Wt("storage:saveNote",{content:i})}catch(a){console.error("[Storage] Failed to save note:",a);try{localStorage.setItem("cs_note",i)}catch{}}}async function jo(){try{if(await $t(),Et()){const i=await Ce.layout.get(1);if(!i)return{};const{id:a,...s}=i;return s}else return await Wt("storage:getLayout")??{}}catch(i){console.error("[Storage] Failed to load layout:",i);try{const a=localStorage.getItem("cs_layout");return a?JSON.parse(a):{}}catch{return{}}}}async function $r(i){try{await $t(),Et()?await Ce.layout.put({id:1,...i}):await Wt("storage:saveLayout",{layout:i})}catch(a){console.error("[Storage] Failed to save layout:",a);try{localStorage.setItem("cs_layout",JSON.stringify(i))}catch{}}}async function Zu(){try{if(await $t(),Et()){const i=await Ce.buttonLayout.get(1);if(!i)return{};const{id:a,...s}=i;return s}else return await Wt("storage:getButtonLayout")??{}}catch(i){console.error("[Storage] Failed to load button layout:",i);try{const a=localStorage.getItem("cs_button_layout");return a?JSON.parse(a):{}}catch{return{}}}}async function es(i){try{await $t(),Et()?await Ce.buttonLayout.put({id:1,...i}):await Wt("storage:saveButtonLayout",{layout:i})}catch(a){console.error("[Storage] Failed to save button layout:",a);try{localStorage.setItem("cs_button_layout",JSON.stringify(i))}catch{}}}var ts=Lr('<div class="resize-handle svelte-1ou1zgf" role="button" tabindex="0" aria-label="Resize panel"></div>'),ns=Lr('<div><div role="button" tabindex="0"><div class="header-title svelte-1ou1zgf">Notes</div> <button class="minimize-button svelte-1ou1zgf">\u2212</button></div> <div class="editor-container svelte-1ou1zgf"><div class="editor svelte-1ou1zgf" contenteditable="true" role="textbox" aria-label="Note editor"></div></div> <!></div>');function rs(i,a){Ar(a,!0);let s=qu(a,"tabMode",3,!1);const c=300;let g=ae(""),w=ae(null),P=ae(!1),S=ae(!1),O=ae(He({x:0,y:0})),C=ae(He({x:0,y:0,width:0,height:0})),L=ae(null),B=ae(null),q=null;function H(V){q&&clearTimeout(q),q=setTimeout(()=>{Ju(V)},c)}function Z(V){const we=V.target;te(g,we.innerText||"",!0),H(U(g))}function ue(V){if(!U(L)||s())return;te(P,!0);const we=U(L).getBoundingClientRect();te(O,{x:V.clientX-we.left,y:V.clientY-we.top},!0),V.preventDefault(),V.stopPropagation()}function Ne(V){if(!U(L)||s())return;te(S,!0);const we=U(L).getBoundingClientRect();te(C,{x:V.clientX,y:V.clientY,width:we.width,height:we.height},!0),V.preventDefault(),V.stopPropagation()}function Me(V){if(U(P)&&U(L)&&U(B)){const we=V.clientX-U(O).x,St=V.clientY-U(O).y;U(B).style.left=`${Math.max(0,Math.min(we,window.innerWidth-100))}px`,U(B).style.top=`${Math.max(0,Math.min(St,window.innerHeight-100))}px`}if(U(S)&&U(L)&&U(B)){const we=V.clientX-U(C).x,St=V.clientY-U(C).y,mn=U(C).width+we,Jr=U(C).height+St;U(B).style.width=`${Math.max(300,mn)}px`,U(B).style.height=`${Math.max(200,Jr)}px`}}function Ae(){if((U(P)||U(S))&&U(B)&&a.onLayoutChange){const V=U(B).getBoundingClientRect();a.onLayoutChange({x:V.left,y:V.top,width:V.width,height:V.height})}te(P,!1),te(S,!1)}function se(){s()?chrome.runtime.sendMessage({type:"close-notes-tab"}).catch(()=>{}):a.onMinimize&&a.onMinimize()}Do(()=>(s()||te(B,document.getElementById("extension-root"),!0),Qu().then(V=>{te(g,V,!0),U(w)&&V&&(U(w).textContent=V)}),s()||(document.addEventListener("mousemove",Me),document.addEventListener("mouseup",Ae)),()=>{s()||(document.removeEventListener("mousemove",Me),document.removeEventListener("mouseup",Ae)),q&&clearTimeout(q)}));var _e=ns();let De;var de=Mr(_e);let fe;de.__mousedown=ue;var Xt=Br(Mr(de),2);Xt.__click=V=>{V.stopPropagation(),se()};var Gn=Br(de,2),yn=Mr(Gn);yn.__input=Z,Vr(yn,V=>te(w,V),()=>U(w));var Qn=Br(Gn,2);{var Pt=V=>{var we=ts();we.__mousedown=Ne,zr(V,we)};Ku(Qn,V=>{s()||V(Pt)})}Vr(_e,V=>te(L,V),()=>U(L)),uo(()=>{De=Yr(_e,1,"panel svelte-1ou1zgf",null,De,{dragging:U(P),resizing:U(S)}),fe=Yr(de,1,"header svelte-1ou1zgf",null,fe,{"tab-mode":s()}),Hr(de,"aria-label",s()?"Notes header":"Drag to move panel"),Hr(Xt,"aria-label",s()?"Close tab":"Minimize panel"),Hr(Xt,"title",s()?"Close":"Minimize")}),zr(i,_e),Dr()}So(["mousedown","click","input"]);var is=Lr('<button tabindex="0" aria-label="Toggle note panel">B</button>');function No(i,a){Ar(a,!0);const s=56,c=5,g=.02,w=.9;let P=ae(null),S=ae(!1),O=ae(!1),C=ae(He({x:0,y:0})),L=ae(He({x:0,y:0})),B=ae(null),q=He({x:0,y:0});function H(se){if(!U(P))return;te(S,!0),te(O,!1);const _e=U(P).getBoundingClientRect();te(C,{x:se.clientX-_e.left,y:se.clientY-_e.top},!0),te(L,{x:se.clientX,y:se.clientY},!0),se.preventDefault(),se.stopPropagation()}function Z(se){if(U(S)&&U(P)&&U(B)){const _e=se.clientX-U(C).x,De=se.clientY-U(C).y,de=Math.max(0,Math.min(_e,window.innerWidth-s)),fe=Math.max(0,Math.min(De,window.innerHeight-s));(Math.abs(se.clientX-U(L).x)>c||Math.abs(se.clientY-U(L).y)>c)&&te(O,!0),q.x=de,q.y=fe,U(B).style.left=`${de}px`,U(B).style.top=`${fe}px`}}function ue(){U(S)&&U(B)&&q.x!==void 0&&q.y!==void 0&&es({x:q.x,y:q.y}),te(S,!1)}function Ne(se){!U(O)&&a.onToggle&&a.onToggle(),te(O,!1)}Do(()=>{if(te(B,document.getElementById("button-root"),!0),!!U(B))return Zu().then(se=>{const De={...{x:window.innerWidth*g,y:window.innerHeight*w},...se};De.x!==void 0&&De.y!==void 0&&(q.x=De.x,q.y=De.y,U(B).style.left=`${De.x}px`,U(B).style.top=`${De.y}px`)}),document.addEventListener("mousemove",Z),document.addEventListener("mouseup",ue),()=>{document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",ue),te(S,!1),te(O,!1)}});var Me=is();let Ae;Me.__mousedown=H,Me.__click=Ne,Vr(Me,se=>te(P,se),()=>U(P)),uo(()=>Ae=Yr(Me,1,"floating-button svelte-1q8htkr",null,Ae,{dragging:U(S)})),zr(i,Me),Dr()}So(["mousedown","click"]);const Mo=2147483647,ct={X_PERCENT:.15,Y_PERCENT:.1,WIDTH_PERCENT:.49,HEIGHT_PERCENT:.8},Vn={X_PERCENT:.02,Y_PERCENT:.9};let Xr=null,kt=null,Wn=null;const Bo=new WeakMap;let Gr=null,qo=new Set;function os(i){let a=0;for(let s=0;s<i.length;s++)a=a*31+i.charCodeAt(s)|0;return`${a}:${i.length}`}function Fo(i,a){const s=i.textContent||"";if(!s)return;const c=Bo.get(a)??new Set,g=os(s);if(c.has(g))return;const w=document.createElement("style");w.textContent=s,a.appendChild(w),c.add(g),Bo.set(a,c)}function Lo(i){const a=i.textContent||"";return a?[".svelte-",".panel",".floating-button",".header",".editor",".resize-handle",".notes-tab-container"].some(c=>a.includes(c)):!1}function as(){Gr||(Gr=new MutationObserver(i=>{for(const a of i)for(const s of Array.from(a.addedNodes))if(s instanceof HTMLStyleElement&&Lo(s))for(const c of qo)Fo(s,c)}),document.head&&Gr.observe(document.head,{childList:!0}))}function Qr(i){qo.add(i),as();for(const s of Array.from(document.head.querySelectorAll("style")))Lo(s)&&Fo(s,i);const a=s=>{if(!Array.from(i.querySelectorAll("link")).some(g=>g.href.includes(s))){const g=chrome.runtime.getURL(s);fetch(g,{method:"HEAD"}).then(w=>{if(w.ok){const P=document.createElement("link");P.rel="stylesheet",P.href=g,i.appendChild(P)}}).catch(()=>{})}};a("content-script.css"),a("style.css"),a("notes.css")}function $n(i){Wn&&(Wn.style.display=i?"block":"none")}function zo(){if(kt)return;const i=document.getElementById("extension-root");if(i&&i.shadowRoot){kt=i,i.shadowRoot;const S=document.getElementById("button-root");if(S&&(Wn=S,(!S.style.left||!S.style.top)&&(S.style.left=`${window.innerWidth*Vn.X_PERCENT}px`,S.style.top=`${window.innerHeight*Vn.Y_PERCENT}px`),!Xr&&S.shadowRoot&&S.shadowRoot.childNodes.length===0)){const O=S.shadowRoot;Qr(O);const C=document.createElement("div");C.style.pointerEvents="auto",O.appendChild(C),Xr=Ur(No,{target:C,props:{onToggle:()=>{Xn()}}})}jo().then(O=>{const L={...{x:window.innerWidth*ct.X_PERCENT,y:window.innerHeight*ct.Y_PERCENT,width:window.innerWidth*ct.WIDTH_PERCENT,height:window.innerHeight*ct.HEIGHT_PERCENT,visible:O.visible!==void 0?O.visible:!0},...O};L.x!==void 0&&L.y!==void 0&&(i.style.left=`${L.x}px`,i.style.top=`${L.y}px`),L.width!==void 0&&L.height!==void 0&&(i.style.width=`${L.width}px`,i.style.height=`${L.height}px`),i.style.display=L.visible?"block":"none",$n(!L.visible),O.minimized&&$n(!0)});return}const a=document.createElement("div");a.id="extension-root",a.style.position="fixed",a.style.zIndex=String(Mo),a.style.pointerEvents="none",document.documentElement.appendChild(a);const s=a.attachShadow({mode:"open"});Qr(s);const c=document.createElement("div");c.style.pointerEvents="auto",c.style.width="100%",c.style.height="100%",s.appendChild(c);const g=document.createElement("div");g.id="button-root",g.style.position="fixed",g.style.zIndex=String(Mo),g.style.pointerEvents="none",g.style.display="block",g.style.left=`${window.innerWidth*Vn.X_PERCENT}px`,g.style.top=`${window.innerHeight*Vn.Y_PERCENT}px`,document.documentElement.appendChild(g);const w=g.attachShadow({mode:"open"});Qr(w);const P=document.createElement("div");P.style.pointerEvents="auto",w.appendChild(P),Wn=g,Xr=Ur(No,{target:P,props:{onToggle:()=>{Xn()}}}),kt=a,jo().then(S=>{const C={...{x:window.innerWidth*ct.X_PERCENT,y:window.innerHeight*ct.Y_PERCENT,width:window.innerWidth*ct.WIDTH_PERCENT,height:window.innerHeight*ct.HEIGHT_PERCENT,visible:S.visible!==void 0?S.visible:!0},...S};C.x!==void 0&&C.y!==void 0&&(a.style.left=`${C.x}px`,a.style.top=`${C.y}px`),C.width!==void 0&&C.height!==void 0&&(a.style.width=`${C.width}px`,a.style.height=`${C.height}px`),a.style.display=C.visible?"block":"none",Ur(rs,{target:c,props:{onLayoutChange:L=>{$r(L)},onMinimize:()=>{Xn()}}}),$n(!C.visible)})}function Xn(){if(!kt){zo();return}const a=!(kt.style.display!=="none");if(a)$r({visible:!0,minimized:!1});else{const s=kt.getBoundingClientRect();$r({x:s.left,y:s.top,width:s.width,height:s.height,visible:a,minimized:!0})}kt.style.display=a?"block":"none",$n(!a)}chrome.runtime.onMessage.addListener(i=>(i.type==="toggle-panel"&&Xn(),!0)),zo()})();
